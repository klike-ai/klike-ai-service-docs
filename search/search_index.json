{"config":{"lang":["pt","en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#klike-ai-services","title":"Klike AI Services","text":"API de An\u00e1lise V\u00eddeos <p>Otimize seus criativos publicit\u00e1rios com an\u00e1lise de IA</p>"},{"location":"#o-que-e-o-klike-ai-services","title":"O que \u00e9 o Klike AI Services?","text":"<p>O Klike AI Services \u00e9 uma API REST poderosa que utiliza intelig\u00eancia artificial para analisar v\u00eddeos publicit\u00e1rios e fornecer insights acion\u00e1veis para otimiza\u00e7\u00e3o de performance em plataformas como Meta, TikTok e LinkedIn.</p>"},{"location":"#principais-funcionalidades","title":"Principais Funcionalidades","text":"yAn\u00e1lise CriativaRecomenda\u00e7\u00f5es PersonalizadasDetec\u00e7\u00e3o de IssuesProcessamento Inteligente <p>Avalie 9 m\u00e9tricas criativas essenciais:</p> <ul> <li>3 Second Hook Score - Primeiros 3 segundos que capturam aten\u00e7\u00e3o</li> <li>Storytelling with Contrast - Narrativa antes/depois</li> <li>Emotional Connection - Conex\u00e3o emocional com a audi\u00eancia</li> <li>Music, Voice-over &amp; Subtitles - Qualidade audiovisual</li> <li>Product Focus - Destaque do produto/servi\u00e7o</li> <li>Value Proposition - Clareza da proposta de valor</li> <li>CTA Score - Efetividade da chamada para a\u00e7\u00e3o</li> <li>Community Score - Autenticidade e conex\u00e3o</li> <li>Video Quality - Qualidade t\u00e9cnica</li> </ul> <p>Receba a\u00e7\u00f5es espec\u00edficas para:</p> <ul> <li>Melhorar m\u00e9tricas criativas com baixo desempenho</li> <li>Corrigir issues t\u00e9cnicas (legendas, safe zone, aspect ratio)</li> <li>Otimizar por plataforma (Meta, TikTok, LinkedIn)</li> <li>Segmentar audi\u00eancias (Gen Z, Millennials, Gen X, Boomers)</li> </ul> <p>Identifique automaticamente:</p> <ul> <li>Legendas fora da safe zone</li> <li>Textos pequenos ou ileg\u00edveis</li> <li>Aspect ratio inadequado para plataforma</li> <li>Viola\u00e7\u00f5es de guideline de plataformas</li> <li>Conte\u00fado que parece fake/n\u00e3o aut\u00eantico</li> <li>Limites de caracteres em Hook/CTA</li> </ul> <ul> <li>Background Tasks - An\u00e1lise ass\u00edncrona sem bloqueio</li> <li>Integra\u00e7\u00e3o S3 - Upload direto do front-end</li> <li>Paraleliza\u00e7\u00e3o - Processamento em paralelo (upload, legendas, frames)</li> <li>Status Tracking - Acompanhe o progresso em tempo real</li> </ul>"},{"location":"#arquitetura","title":"Arquitetura","text":"<pre><code>graph LR\n    A[Cliente] --&gt;|Upload V\u00eddeo| B[FastAPI]\n    A --&gt;|Upload S3| C[AWS S3]\n    C --&gt;|Download| B\n    B --&gt;|Upload| D[Google Gemini 2.5 Pro]\n    B --&gt;|Processar| E[AWS Rekognition]\n    B --&gt;|Frames| F[Supabase Storage]\n    D --&gt;|An\u00e1lise| B\n    E --&gt;|Legendas| B\n    B --&gt;|Gerar A\u00e7\u00f5es| G[OpenAI GPT-4o]\n    G --&gt;|Recomenda\u00e7\u00f5es| B\n    B --&gt;|Response| A\n\n    style A fill:#e1f5ff\n    style B fill:#fff3cd\n    style D fill:#d4edda\n    style G fill:#f8d7da</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":""},{"location":"#1-instalacao","title":"1. Instala\u00e7\u00e3o","text":"<pre><code># Clone o reposit\u00f3rio\ngit clone https://github.com/klike-ai/klike-ai-services.git\ncd klike-ai-services\n\n# Crie ambiente virtual\npython -m venv env\nsource env/bin/activate  # Windows: env\\Scripts\\activate\n\n# Instale depend\u00eancias\npip install -r requirements.txt\n</code></pre>"},{"location":"#2-configuracao","title":"2. Configura\u00e7\u00e3o","text":"<p>Crie um arquivo <code>.env</code> na raiz do projeto:</p> <pre><code># Google Gemini\nGOOGLE_API_KEY=sua_chave_google_gemini\n\n# OpenAI\nOPENAI_API_KEY=sua_chave_openai\n\n# AWS\nAWS_ACCESS_KEY_ID=sua_access_key\nAWS_SECRET_ACCESS_KEY=sua_secret_key\nAWS_REGION=us-east-1\nS3_BUCKET_NAME=seu-bucket\n\n# Supabase\nSUPABASE_URL=sua_url_supabase\nSUPABASE_KEY=sua_chave_supabase\nSUPABASE_BUCKET=seu_bucket_supabase\n</code></pre>"},{"location":"#3-execute-a-api","title":"3. Execute a API","text":"<pre><code>uvicorn app.app:app --reload --host 0.0.0.0 --port 8000\n</code></pre> <p>Acesse: http://localhost:8000/docs</p>"},{"location":"#casos-de-uso","title":"Casos de Uso","text":"<p>Ag\u00eancias de Publicidade</p> <p>Analise dezenas de criativos antes de veicula\u00e7\u00e3o e otimize baseado em dados</p> <p>Equipes de Marketing</p> <p>Entenda por que alguns v\u00eddeos performam melhor e replique o sucesso</p> <p>Criadores de Conte\u00fado</p> <p>Receba feedback instant\u00e2neo sobre seus v\u00eddeos antes de publicar</p> <p>E-commerce</p> <p>Otimize v\u00eddeos de produto para diferentes plataformas e audi\u00eancias</p>"},{"location":"api/background-tasks/","title":"Background Tasks","text":""},{"location":"api/background-tasks/#background-tasks","title":"Background Tasks","text":"<p>As an\u00e1lises de v\u00eddeo s\u00e3o processadas de forma ass\u00edncrona usando um sistema de tasks em background, permitindo que a API responda imediatamente sem bloquear o cliente.</p>"},{"location":"api/background-tasks/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>Quando voc\u00ea envia um v\u00eddeo para an\u00e1lise, a API:</p> <ol> <li>Valida o v\u00eddeo e cria um registro no banco</li> <li>Retorna imediatamente com um <code>task_id</code></li> <li>Processa em background a an\u00e1lise completa</li> <li>Notifica quando completo (via webhook ou polling)</li> </ol> <pre><code>sequenceDiagram\n    participant Client\n    participant API\n    participant Queue\n    participant Worker\n    participant DB\n\n    Client-&gt;&gt;API: POST /analyze-video\n    API-&gt;&gt;DB: Create task record\n    API-&gt;&gt;Queue: Enqueue task\n    API--&gt;&gt;Client: 202 Accepted {task_id}\n\n    Queue-&gt;&gt;Worker: Process task\n    Worker-&gt;&gt;Worker: Extract audio\n    Worker-&gt;&gt;Worker: Transcribe\n    Worker-&gt;&gt;Worker: Analyze with AI\n    Worker-&gt;&gt;DB: Update task status\n\n    Client-&gt;&gt;API: GET /task/{task_id}\n    API-&gt;&gt;DB: Query task status\n    API--&gt;&gt;Client: 200 OK {result}</code></pre>"},{"location":"api/background-tasks/#estados-das-tasks","title":"Estados das Tasks","text":"Estado Descri\u00e7\u00e3o A\u00e7\u00e3o Recomendada <code>queued</code> Task aguardando processamento Continue polling <code>processing</code> An\u00e1lise em andamento Continue polling <code>completed</code> An\u00e1lise finalizada com sucesso Recupere os resultados <code>failed</code> Erro durante processamento Verifique o erro e reenvie <code>cancelled</code> Task cancelada pelo usu\u00e1rio -"},{"location":"api/background-tasks/#consultar-status","title":"Consultar Status","text":""},{"location":"api/background-tasks/#endpoint","title":"Endpoint","text":"<pre><code>GET video/tasks/{task_id}\n</code></pre>"},{"location":"api/background-tasks/#exemplo-de-requisicao","title":"Exemplo de Requisi\u00e7\u00e3o","text":"PythoncURLJavaScript <pre><code>import requests\nimport time\n\ntask_id = \"550e8400-e29b-41d4-a716-446655440000\"\n\nwhile True:\n    response = requests.get(f\"http://localhost:8000/video/tasks/{task_id}\")\n    task = response.json()\n\n    if task[\"status\"] == \"completed\":\n        print(\"An\u00e1lise completa!\")\n        print(f\"Score: {task['result']['score']}\")\n        break\n    elif task[\"status\"] == \"failed\":\n        print(f\"Erro: {task['error']}\")\n        break\n    else:\n        print(f\"Status: {task['status']} - Progress: {task['progress']}%\")\n        time.sleep(2)  # Aguarda 2 segundos antes de verificar novamente\n</code></pre> <pre><code>curl http://localhost:8000/video/tasks/550e8400-e29b-41d4-a716-446655440000\n</code></pre> <pre><code>async function pollTask(taskId) {\n  while (true) {\n    const response = await fetch(`http://localhost:8000/video/tasks/${taskId}`);\n    const task = await response.json();\n\n    if (task.status === 'completed') {\n      console.log('An\u00e1lise completa!', task.result);\n      return task.result;\n    } else if (task.status === 'failed') {\n      throw new Error(task.error);\n    } else {\n      console.log(`Status: ${task.status} - Progress: ${task.progress}%`);\n      await new Promise(resolve =&gt; setTimeout(resolve, 2000));\n    }\n  }\n}\n\npollTask('550e8400-e29b-41d4-a716-446655440000')\n  .then(result =&gt; console.log('Score:', result.score))\n  .catch(error =&gt; console.error('Erro:', error));\n</code></pre>"},{"location":"api/background-tasks/#resposta","title":"Resposta","text":"<pre><code>{\n  \"task_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"status\": \"processing\",\n  \"progress\": 65,\n  \"created_at\": \"2024-01-15T10:30:00Z\",\n  \"updated_at\": \"2024-01-15T10:32:45Z\",\n  \"estimated_completion\": \"2024-01-15T10:35:00Z\",\n  \"metadata\": {\n    \"video_duration\": 45.2,\n    \"video_size_mb\": 12.5,\n    \"current_step\": \"ai_analysis\"\n  }\n}\n</code></pre>"},{"location":"api/background-tasks/#tempos-de-processamento","title":"Tempos de Processamento","text":"<p>O tempo de processamento varia conforme o tamanho e complexidade do v\u00eddeo:</p> Dura\u00e7\u00e3o do V\u00eddeo Tempo Estimado 0-30s 30-60s 30s-1min 1-2min 1-3min 2-5min 3-5min 5-8min 5min+ 8-15min"},{"location":"api/background-tasks/#processamento-paralelo","title":"Processamento Paralelo","text":"<p>O sistema realiza m\u00faltiplas opera\u00e7\u00f5es em paralelo para otimizar o tempo:</p> <pre><code>graph LR\n    Start[V\u00eddeo Baixado] --&gt; Parallel{Processamento Paralelo}\n\n    Parallel --&gt; Upload[Upload para Gemini]\n    Parallel --&gt; Subtitles[Processar Legendas]\n    Parallel --&gt; AspectRatio[Validar Aspect Ratio]\n\n    Upload --&gt; Sync1[Aguardar ACTIVE]\n    Subtitles --&gt; Sync2[Verificar Safe Zone]\n    AspectRatio --&gt; Sync3[Extrair Frame]\n\n    Sync1 --&gt; Continue[Continuar An\u00e1lise]\n    Sync2 --&gt; Continue\n    Sync3 --&gt; Continue\n\n    Continue --&gt; AI[An\u00e1lise com IA]</code></pre> <p>Opera\u00e7\u00f5es Paralelas:</p> <ol> <li>Upload do v\u00eddeo para Google Gemini</li> <li>Processamento de legendas e verifica\u00e7\u00e3o de safe zone</li> <li>Valida\u00e7\u00e3o de aspect ratio e captura de frame (se necess\u00e1rio)</li> </ol> <p>Benef\u00edcios:</p> <ul> <li>Redu\u00e7\u00e3o de at\u00e9 40% no tempo total de processamento</li> <li>Melhor utiliza\u00e7\u00e3o de recursos do servidor</li> <li>Resposta mais r\u00e1pida para o usu\u00e1rio</li> </ul> <p>Exemplo de Implementa\u00e7\u00e3o:</p> <pre><code>import concurrent.futures\n\ndef process_video_background(task_id, video_path):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=3) as executor:\n        # Submeter tasks em paralelo\n        future_upload = executor.submit(upload_to_gemini, video_path)\n        future_subtitles = executor.submit(process_subtitles, video_path)\n        future_aspect_ratio = executor.submit(check_aspect_ratio, video_path)\n\n        # Aguardar resultados\n        uploaded = future_upload.result()\n        subtitles = future_subtitles.result()\n        aspect_ratio = future_aspect_ratio.result()\n\n        # Continuar com an\u00e1lise\n        return analyze_with_ai(uploaded, subtitles, aspect_ratio)\n</code></pre> <p>Otimiza\u00e7\u00e3o</p> <ul> <li>V\u00eddeos em resolu\u00e7\u00e3o 1080p ou superior podem levar mais tempo</li> <li>Compress\u00e3o pr\u00e9via pode reduzir o tempo de processamento</li> <li>Use upload direto para S3 para reduzir lat\u00eancia</li> <li>Processamento paralelo reduz tempo em 30-40%</li> </ul>"},{"location":"api/background-tasks/#webhooks-futuro","title":"Webhooks (Futuro)","text":"<p>Em breve, voc\u00ea poder\u00e1 configurar webhooks para receber notifica\u00e7\u00f5es autom\u00e1ticas:</p> <pre><code>{\n  \"webhook_url\": \"https://seu-servidor.com/webhook\",\n  \"events\": [\"task.completed\", \"task.failed\"]\n}\n</code></pre> <p>Quando a task for conclu\u00edda, voc\u00ea receber\u00e1:</p> <pre><code>{\n  \"event\": \"task.completed\",\n  \"task_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"timestamp\": \"2024-01-15T10:35:00Z\",\n  \"result\": {\n    \"score\": 8.7,\n    \"creative_score\": {...},\n    \"detected_issues\": [...]\n  }\n}\n</code></pre>"},{"location":"api/background-tasks/#cancelar-task","title":"Cancelar Task","text":""},{"location":"api/background-tasks/#endpoint_1","title":"Endpoint","text":"<pre><code>DELETE /video/tasks/{task_id}\n</code></pre>"},{"location":"api/background-tasks/#exemplo","title":"Exemplo","text":"PythoncURL <pre><code>import requests\n\ntask_id = \"550e8400-e29b-41d4-a716-446655440000\"\nresponse = requests.delete(f\"http://localhost:8000/video/tasks/{task_id}\")\n\nif response.status_code == 200:\n    print(\"Task cancelada com sucesso!\")\n</code></pre> <pre><code>curl -X DELETE http://localhost:8000/video/tasks/550e8400-e29b-41d4-a716-446655440000\n</code></pre> <p>Aten\u00e7\u00e3o</p> <p>Tasks em estado <code>processing</code> podem levar alguns segundos para serem canceladas completamente.</p>"},{"location":"api/background-tasks/#listar-tasks","title":"Listar Tasks","text":""},{"location":"api/background-tasks/#endpoint_2","title":"Endpoint","text":"<pre><code>GET /video/tasks?status=completed&amp;limit=10\n</code></pre>"},{"location":"api/background-tasks/#parametros-de-query","title":"Par\u00e2metros de Query","text":"Par\u00e2metro Tipo Descri\u00e7\u00e3o Default <code>status</code> string Filtrar por status Todos <code>limit</code> integer N\u00famero de resultados 20 <code>offset</code> integer Pagina\u00e7\u00e3o 0 <code>sort</code> string Ordena\u00e7\u00e3o (<code>created_at</code>, <code>-created_at</code>) <code>-created_at</code>"},{"location":"api/background-tasks/#exemplo_1","title":"Exemplo","text":"<pre><code>import requests\n\nresponse = requests.get(\n    \"http://localhost:8000/video/tasks\",\n    params={\n        \"status\": \"completed\",\n        \"limit\": 10,\n        \"sort\": \"-created_at\"\n    }\n)\n\ntasks = response.json()\nfor task in tasks[\"items\"]:\n    print(f\"{task['task_id']}: Score {task['result']['score']}\")\n</code></pre>"},{"location":"api/background-tasks/#resposta_1","title":"Resposta","text":"<pre><code>{\n  \"total\": 150,\n  \"limit\": 10,\n  \"offset\": 0,\n  \"items\": [\n    {\n      \"task_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"status\": \"completed\",\n      \"created_at\": \"2024-01-15T10:30:00Z\",\n      \"result\": {\n        \"score\": 8.7,\n        \"video_url\": \"https://...\"\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"api/background-tasks/#melhores-praticas","title":"Melhores Pr\u00e1ticas","text":""},{"location":"api/background-tasks/#polling-inteligente","title":"Polling Inteligente","text":"<p>Use backoff exponencial para reduzir carga:</p> <pre><code>import time\n\ndef smart_poll(task_id, initial_delay=2, max_delay=30):\n    delay = initial_delay\n\n    while True:\n        response = requests.get(f\"http://localhost:8000/video/tasks/{task_id}\")\n        task = response.json()\n\n        if task[\"status\"] in [\"completed\", \"failed\"]:\n            return task\n\n        time.sleep(delay)\n        delay = min(delay * 1.5, max_delay)  # Aumenta o delay gradualmente\n</code></pre>"},{"location":"api/background-tasks/#tratamento-de-erros","title":"Tratamento de Erros","text":"<pre><code>def process_task(task_id, max_retries=3):\n    for attempt in range(max_retries):\n        try:\n            result = poll_task(task_id)\n            return result\n        except requests.exceptions.Timeout:\n            if attempt == max_retries - 1:\n                raise\n            time.sleep(2 ** attempt)  # Exponential backoff\n        except requests.exceptions.RequestException as e:\n            print(f\"Erro na tentativa {attempt + 1}: {e}\")\n            if attempt == max_retries - 1:\n                raise\n</code></pre>"},{"location":"api/background-tasks/#troubleshooting","title":"Troubleshooting","text":""},{"location":"api/background-tasks/#task-travada-em-processing","title":"Task travada em \"processing\"","text":"<p>Se uma task ficar mais de 15 minutos em processamento:</p> <ol> <li>Verifique se o worker est\u00e1 ativo</li> <li>Consulte os logs do servidor</li> <li>Cancele e reenvie o v\u00eddeo</li> </ol>"},{"location":"api/background-tasks/#erros-comuns","title":"Erros comuns","text":"Erro Causa Solu\u00e7\u00e3o <code>TASK_NOT_FOUND</code> Task ID inv\u00e1lido Verifique o ID retornado <code>TASK_EXPIRED</code> Task muito antiga (&gt;7 dias) Reenvie o v\u00eddeo <code>PROCESSING_TIMEOUT</code> V\u00eddeo muito longo Divida o v\u00eddeo ou reduza resolu\u00e7\u00e3o"},{"location":"api/background-tasks/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Explore a Integra\u00e7\u00e3o S3 para uploads diretos</li> </ul>"},{"location":"api/calculator/","title":"Calculadora","text":""},{"location":"api/calculator/#calculadora-de-orcamento","title":"Calculadora de Or\u00e7amento","text":"<p>A API inclui uma calculadora inteligente para estimar custos de produ\u00e7\u00e3o de v\u00eddeos publicit\u00e1rios baseados em diversos par\u00e2metros.</p>"},{"location":"api/calculator/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>A calculadora considera:</p> <ul> <li>Dura\u00e7\u00e3o do v\u00eddeo</li> <li>Qualidade de produ\u00e7\u00e3o (b\u00e1sica, profissional, premium)</li> <li>Tipo de v\u00eddeo (UGC, anima\u00e7\u00e3o, filmagem, etc.)</li> <li>Recursos necess\u00e1rios (loca\u00e7\u00f5es, atores, edi\u00e7\u00e3o, etc.)</li> <li>Regi\u00e3o geogr\u00e1fica</li> </ul>"},{"location":"api/calculator/#endpoint","title":"Endpoint","text":"<pre><code>POST /calculate-budget\n</code></pre>"},{"location":"api/calculator/#autenticacao","title":"Autentica\u00e7\u00e3o","text":"<p>N\u00e3o requer autentica\u00e7\u00e3o (endpoint p\u00fablico).</p>"},{"location":"api/calculator/#requisicao","title":"Requisi\u00e7\u00e3o","text":""},{"location":"api/calculator/#parametros","title":"Par\u00e2metros","text":"Par\u00e2metro Tipo Descri\u00e7\u00e3o Obrigat\u00f3rio <code>monthly_revenue_goal</code> <code>float</code> Meta de receita mensal desejada (em USD) \u2705 Sim <code>avg_ticket_price</code> <code>float</code> Pre\u00e7o m\u00e9dio por venda (em USD) \u2705 Sim <code>score</code> <code>int</code> Score de qualidade desejado (0-100) \u2705 Sim"},{"location":"api/calculator/#exemplo-de-requisicao","title":"Exemplo de Requisi\u00e7\u00e3o","text":"<pre><code>import requests\ndata = {\n    \"monthly_revenue_goal\": 10000.0,\n    \"avg_ticket_price\": 50.0,\n    \"score\": 85\n}\nresponse = requests.post(\n    \"http://localhost:8000/calculate-budget\",\n    json=data\n)\nbudget_estimate = response.json()\nprint(budget_estimate)\n</code></pre>"},{"location":"api/calculator/#resposta","title":"Resposta","text":""},{"location":"api/calculator/#exemplo-de-resposta","title":"Exemplo de Resposta","text":"<pre><code>{\n  \"budget_range\": {\n    \"min_budget\": 5600,\n    \"max_budget\": 9400\n  }\n}\n</code></pre>"},{"location":"api/calculator/#descricao-dos-campos","title":"Descri\u00e7\u00e3o dos Campos","text":"Campo Tipo Descri\u00e7\u00e3o <code>min_budget</code> <code>float</code> Or\u00e7amento m\u00ednimo estimado (em USD) <code>max_budget</code> <code>float</code> Or\u00e7amento m\u00e1ximo estimado (em USD)"},{"location":"api/calculator/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>An\u00e1lise de V\u00eddeos - Analise v\u00eddeos existentes</li> <li>Upload para S3 - Envie v\u00eddeos diretamente para S3</li> <li>Tarefas em Background - Gerencie an\u00e1lises ass\u00edncronas</li> </ul>"},{"location":"api/overview/","title":"Vis\u00e3o Geral","text":""},{"location":"api/overview/#api-reference-visao-geral","title":"API Reference - Vis\u00e3o Geral","text":"<p>Documenta\u00e7\u00e3o completa dos endpoints da Klike AI Services API.</p>"},{"location":"api/overview/#base-url","title":"Base URL","text":"<pre><code>http://localhost:8000\n</code></pre> <p>Produ\u00e7\u00e3o: <code>https://api.klike.ai</code> (quando dispon\u00edvel)</p>"},{"location":"api/overview/#autenticacao","title":"Autentica\u00e7\u00e3o","text":"<p>Atualmente a API n\u00e3o requer autentica\u00e7\u00e3o para desenvolvimento. Em produ\u00e7\u00e3o, ser\u00e1 necess\u00e1rio:</p> <pre><code>curl -H \"Authorization: Bearer YOUR_API_KEY\" \\\n     \"https://api.klike.ai/video/task/123\"\n</code></pre>"},{"location":"api/overview/#endpoints-disponiveis","title":"Endpoints Dispon\u00edveis","text":""},{"location":"api/overview/#analise-de-videos","title":"An\u00e1lise de V\u00eddeos","text":"M\u00e9todo Endpoint Descri\u00e7\u00e3o <code>POST</code> <code>/video/analyze-from-s3</code> An\u00e1lise de v\u00eddeo j\u00e1 no S3 <code>GET</code> <code>/video/task/{task_id}</code> Consultar status da tarefa <code>GET</code> <code>/video/tasks</code> Listar todas as tarefas"},{"location":"api/overview/#s3-integration","title":"S3 Integration","text":"M\u00e9todo Endpoint Descri\u00e7\u00e3o <code>GET</code> <code>/video/list-s3-videos</code> Listar v\u00eddeos dispon\u00edveis no S3 <code>GET</code> <code>/video/check-s3-video/{file_id}</code> Verificar se v\u00eddeo existe no S3"},{"location":"api/overview/#calculadora","title":"Calculadora","text":"M\u00e9todo Endpoint Descri\u00e7\u00e3o <code>POST</code> <code>/calculate-budget</code> Calcular budget baseado em meta de receita"},{"location":"api/overview/#swagger-ui-interativa","title":"Swagger UI Interativa","text":"<p>Acesse a documenta\u00e7\u00e3o interativa em:</p> <p>http://localhost:8000/docs</p> <p>L\u00e1 voc\u00ea pode:</p> <ul> <li>\u2705 Testar todos os endpoints</li> <li>\u2705 Ver schemas de request/response</li> <li>\u2705 Copiar exemplos de c\u00f3digo</li> </ul>"},{"location":"api/overview/#modelos-de-dados","title":"Modelos de Dados","text":""},{"location":"api/overview/#videoanalysisrequest","title":"VideoAnalysisRequest","text":"<pre><code>{\n  \"file\": \"video.mp4\",           # Arquivo MP4\n  \"audience\": [\"millennials\"],   # Lista de audi\u00eancias\n  \"platform_type\": [\"meta\"],     # Lista de plataformas\n  \"language\": \"pt\"               # pt ou en\n}\n</code></pre>"},{"location":"api/overview/#taskresponse","title":"TaskResponse","text":"<pre><code>{\n  \"task_id\": \"uuid\",\n  \"status\": \"completed\",          # pending, processing, completed, failed\n  \"progress\": 100,                # 0-100\n  \"created_at\": \"2025-12-08T...\",\n  \"updated_at\": \"2025-12-08T...\",\n  \"file_name\": \"s3://video.mp4\",\n  \"result\": {                     # S\u00f3 quando completed\n    \"score\": 75,\n    \"stage\": \"B\",\n    \"analysis\": {...},\n    \"actions\": {...}\n  }\n}\n</code></pre>"},{"location":"api/overview/#videoanalysisresult","title":"VideoAnalysisResult","text":"<pre><code>{\n  \"score\": 75,\n  \"stage\": \"B\",\n  \"analysis\": {\n    \"creative_metrics\": [\n      {\n        \"metric_name\": \"3 Second Hook Score\",\n        \"score\": 85,\n        \"stage\": \"A\",\n        \"reasoning\": {\n          \"what_went_well\": [\"...\"],\n          \"room_for_improvement\": [\"...\"]\n        }\n      }\n    ],\n    \"audience_scores\": {\n      \"genz\": \"Gera\u00e7\u00e3o Z\",\n      \"score_genz\": 55,\n      \"reasoning_genz\": \"...\"\n    },\n    \"platform_recommendations\": [\n      {\n        \"platform\": \"meta\",\n        \"recommendations\": [\"...\"]\n      }\n    ],\n    \"detected_issues\": {\n      \"safezone\": true,\n      \"details_safezone\": {...}\n    }\n  },\n  \"actions\": {\n    \"actions_creatives\": {...},\n    \"actions_issues\": {...},\n    \"actions_platforms\": {...},\n    \"actions_audiences\": {...}\n  },\n  \"warning\": {\n    \"compliance_status\": \"compliance\",\n    \"issues_found\": []\n  }\n}\n</code></pre>"},{"location":"api/overview/#tipos-de-audiencia","title":"Tipos de Audi\u00eancia","text":"Valor Descri\u00e7\u00e3o Caracter\u00edsticas <code>genz</code> Gera\u00e7\u00e3o Z (1997-2012) Autenticidade, trends, UGC <code>millennials</code> Millennials (1981-1996) Prop\u00f3sito, storytelling <code>genx</code> Gera\u00e7\u00e3o X (1965-1980) Pragmatismo, valor claro <code>boomer</code> Boomers (1946-1964) Confian\u00e7a, simplicidade"},{"location":"api/overview/#tipos-de-plataforma","title":"Tipos de Plataforma","text":"Valor Plataforma Formato Ideal <code>meta</code> Facebook/Instagram 9:16, 1:1, 4:5 <code>tiktok</code> TikTok 9:16 <code>linkedin</code> LinkedIn 16:9, 1:1"},{"location":"api/overview/#idiomas-suportados","title":"Idiomas Suportados","text":"C\u00f3digo Idioma <code>pt</code> Portugu\u00eas <code>en</code> Ingl\u00eas"},{"location":"api/overview/#codigos-de-erro","title":"C\u00f3digos de Erro","text":"C\u00f3digo Descri\u00e7\u00e3o Solu\u00e7\u00e3o <code>400</code> Bad Request Verifique os par\u00e2metros <code>404</code> Not Found Task ID inv\u00e1lido <code>413</code> Payload Too Large V\u00eddeo &gt; 100MB <code>422</code> Unprocessable Entity Formato inv\u00e1lido <code>500</code> Internal Server Error Veja logs do servidor"},{"location":"api/overview/#exemplo-de-erro","title":"Exemplo de Erro","text":"<pre><code>{\n  \"detail\": \"V\u00eddeo muito grande. M\u00e1ximo: 100MB\"\n}\n</code></pre>"},{"location":"api/overview/#guias-detalhados","title":"Guias Detalhados","text":"<p>Explore a documenta\u00e7\u00e3o espec\u00edfica de cada endpoint:</p> <p>An\u00e1lise de V\u00eddeos - Integra\u00e7\u00e3o S3 - Background Tasks - Calculadora de Budget</p>"},{"location":"api/overview/#exemplos-de-integracao","title":"Exemplos de Integra\u00e7\u00e3o","text":""},{"location":"api/overview/#javascriptreact","title":"JavaScript/React","text":"<pre><code>const analyzeVideo = async (videoFile) =&gt; {\n  const formData = new FormData();\n  formData.append('file', videoFile);\n  formData.append('audience', 'millennials');\n  formData.append('platform_type', 'meta');\n  formData.append('language', 'pt');\n\n  const response = await fetch('http://localhost:8000/video/upload-video-async', {\n    method: 'POST',\n    body: formData\n  });\n\n  const { task_id } = await response.json();\n\n  // Polling\n  const checkStatus = async () =&gt; {\n    const res = await fetch(`http://localhost:8000/video/task/${task_id}`);\n    const data = await res.json();\n\n    if (data.status === 'completed') {\n      return data.result;\n    } else if (data.status === 'failed') {\n      throw new Error(data.error);\n    }\n\n    await new Promise(r =&gt; setTimeout(r, 2000));\n    return checkStatus();\n  };\n\n  return await checkStatus();\n};\n</code></pre>"},{"location":"api/overview/#python","title":"Python","text":"<pre><code>import requests\nimport time\n\ndef analyze_video(video_path, audience, platform):\n    # Upload\n    with open(video_path, 'rb') as f:\n        response = requests.post(\n            'http://localhost:8000/video/upload-video-async',\n            files={'file': f},\n            data={\n                'audience': audience,\n                'platform_type': platform,\n                'language': 'pt'\n            }\n        )\n\n    task_id = response.json()['task_id']\n\n    # Polling\n    while True:\n        response = requests.get(\n            f'http://localhost:8000/video/task/{task_id}'\n        )\n        data = response.json()\n\n        if data['status'] == 'completed':\n            return data['result']\n        elif data['status'] == 'failed':\n            raise Exception(data['error'])\n\n        time.sleep(2)\n</code></pre>"},{"location":"api/s3-integration/","title":"S3 Integration","text":""},{"location":"api/s3-integration/#integracao-s3","title":"Integra\u00e7\u00e3o S3","text":"<p>Upload direto do frontend para AWS S3, ideal para v\u00eddeos grandes.</p>"},{"location":"api/s3-integration/#por-que-usar-s3","title":"Por que usar S3?","text":""},{"location":"api/s3-integration/#vantagens","title":"Vantagens","text":"<p>\u2705 Upload mais r\u00e1pido - Cliente \u2192 S3 direto (sem passar pela API) \u2705 Sem limite de tamanho - V\u00eddeos at\u00e9 5GB \u2705 Menor carga no servidor - API apenas processa \u2705 Resumable uploads - Retomar upload em caso de falha \u2705 CDN integration - Distribui\u00e7\u00e3o global via CloudFront  </p>"},{"location":"api/s3-integration/#fluxo-tradicional-vs-s3","title":"Fluxo Tradicional vs S3","text":"Tradicional (Lento)S3 (R\u00e1pido) <pre><code>sequenceDiagram\n    Frontend-&gt;&gt;API: Upload 500MB\n    Note over API: Recebe todo o v\u00eddeo\n    API-&gt;&gt;Gemini: Processa\n    Gemini--&gt;&gt;API: Resultado\n    API--&gt;&gt;Frontend: Response</code></pre> <pre><code>sequenceDiagram\n    Frontend-&gt;&gt;S3: Upload direto\n    S3--&gt;&gt;Frontend: file_id\n    Frontend-&gt;&gt;API: analyze-from-s3\n    API-&gt;&gt;S3: Download (interno)\n    API-&gt;&gt;Gemini: Processa\n    Gemini--&gt;&gt;API: Resultado\n    API--&gt;&gt;Frontend: Response</code></pre>"},{"location":"api/s3-integration/#endpoints","title":"Endpoints","text":""},{"location":"api/s3-integration/#post-videoanalyze-from-s3","title":"<code>POST /video/analyze-from-s3</code>","text":"<p>Analisa v\u00eddeo j\u00e1 armazenado no S3.</p>"},{"location":"api/s3-integration/#request","title":"Request","text":"<pre><code>{\n  \"file_id\": \"2025_INSPER_CRIATIVO_6_V3\",\n  \"audience\": [\"millennials\"],\n  \"platform_type\": [\"meta\"],\n  \"language\": \"pt\"\n}\n</code></pre> Campo Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o <code>file_id</code> String \u2705 Sim ID do v\u00eddeo no S3 (sem extens\u00e3o) <code>audience</code> Array \u274c N\u00e3o Lista de audi\u00eancias <code>platform_type</code> Array \u274c N\u00e3o Lista de plataformas <code>language</code> String \u274c N\u00e3o <code>pt</code> ou <code>en</code>"},{"location":"api/s3-integration/#response","title":"Response","text":"<pre><code>{\n  \"task_id\": \"a1b2c3d4-e5f6-7890\",\n  \"status\": \"accepted\",\n  \"message\": \"An\u00e1lise do v\u00eddeo S3 iniciada...\",\n  \"check_status_url\": \"/video/task/a1b2c3d4-e5f6-7890\",\n  \"file_id\": \"2025_INSPER_CRIATIVO_6_V3\"\n}\n</code></pre>"},{"location":"api/s3-integration/#get-videolist-s3-videos","title":"<code>GET /video/list-s3-videos</code>","text":"<p>Lista todos os v\u00eddeos dispon\u00edveis no bucket S3.</p>"},{"location":"api/s3-integration/#request_1","title":"Request","text":"<pre><code>curl \"http://localhost:8000/video/list-s3-videos\"\n</code></pre>"},{"location":"api/s3-integration/#response_1","title":"Response","text":"<pre><code>{\n  \"total_videos\": 5,\n  \"file_ids\": [\n    \"2025_INSPER_CRIATIVO_6_V3\",\n    \"2025_NIKE_SUMMER_CAMPAIGN\",\n    \"2025_COCA_COLA_HOLIDAY\"\n  ],\n  \"videos_details\": [\n    {\n      \"file_id\": \"2025_INSPER_CRIATIVO_6_V3\",\n      \"key\": \"mp4/2025_INSPER_CRIATIVO_6_V3.mp4\",\n      \"size\": 52428800,\n      \"size_mb\": 50.0,\n      \"last_modified\": \"2025-12-08T16:30:00\",\n      \"filename\": \"2025_INSPER_CRIATIVO_6_V3.mp4\"\n    }\n  ],\n  \"message\": \"5 v\u00eddeo(s) dispon\u00edvel(is) no S3\"\n}\n</code></pre>"},{"location":"api/s3-integration/#get-videocheck-s3-videofile_id","title":"<code>GET /video/check-s3-video/{file_id}</code>","text":"<p>Verifica se um v\u00eddeo espec\u00edfico existe no S3.</p>"},{"location":"api/s3-integration/#request_2","title":"Request","text":"<pre><code>curl \"http://localhost:8000/video/check-s3-video/2025_INSPER_CRIATIVO_6_V3\"\n</code></pre>"},{"location":"api/s3-integration/#response-encontrado","title":"Response - Encontrado","text":"<pre><code>{\n  \"file_id\": \"2025_INSPER_CRIATIVO_6_V3\",\n  \"exists\": true,\n  \"status\": {\n    \"mp4\": true,\n    \"mp3\": false,\n    \"output\": false,\n    \"metadata\": false\n  },\n  \"message\": \"V\u00eddeo encontrado e pronto para processamento\",\n  \"s3_path\": \"s3://test-bucket-video-klikeai/mp4/2025_INSPER_CRIATIVO_6_V3.mp4\"\n}\n</code></pre>"},{"location":"api/s3-integration/#response-nao-encontrado","title":"Response - N\u00e3o Encontrado","text":"<p>Status: 404 Not Found</p> <pre><code>{\n  \"detail\": \"V\u00eddeo 2025_INSPER_CRIATIVO_6_V3.mp4 n\u00e3o encontrado no S3. Fa\u00e7a upload na pasta mp4/ do bucket.\"\n}\n</code></pre>"},{"location":"api/s3-integration/#estrutura-do-bucket","title":"Estrutura do Bucket","text":"<p>O bucket S3 segue esta organiza\u00e7\u00e3o:</p> <pre><code>test-bucket-video-klikeai/\n\u251c\u2500\u2500 mp4/                     # V\u00eddeos originais (obrigat\u00f3rio)\n\u2502   \u251c\u2500\u2500 2025_INSPER_CRIATIVO_6_V3.mp4\n\u2502   \u251c\u2500\u2500 2025_NIKE_SUMMER.mp4\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 mp3/                     # \u00c1udios extra\u00eddos (futuro)\n\u2502   \u2514\u2500\u2500 2025_INSPER_CRIATIVO_6_V3.mp3\n\u251c\u2500\u2500 outputs/                 # Transcri\u00e7\u00f5es (futuro)\n\u2502   \u2514\u2500\u2500 2025_INSPER_CRIATIVO_6_V3.txt\n\u2514\u2500\u2500 metadata/                # Metadados JSON (futuro)\n    \u2514\u2500\u2500 2025_INSPER_CRIATIVO_6_V3.json\n</code></pre>"},{"location":"api/s3-integration/#implementacao-frontend","title":"Implementa\u00e7\u00e3o Frontend","text":""},{"location":"api/s3-integration/#upload-direto-para-s3","title":"Upload Direto para S3","text":""},{"location":"api/s3-integration/#1-obter-presigned-url-backend","title":"1. Obter Presigned URL (Backend)","text":"<pre><code>from app.utils.s3 import S3Handler\n\n@router.post(\"/video/get-upload-url\")\nasync def get_upload_url(file_id: str):\n    \"\"\"\n    Gera URL presigned para upload direto do frontend\n    \"\"\"\n    s3_handler = S3Handler()\n\n    # Gerar URL presigned para PUT\n    url = s3_handler.s3_client.generate_presigned_url(\n        'put_object',\n        Params={\n            'Bucket': s3_handler.bucket_name,\n            'Key': f'mp4/{file_id}.mp4',\n            'ContentType': 'video/mp4'\n        },\n        ExpiresIn=3600  # 1 hora\n    )\n\n    return {\n        \"upload_url\": url,\n        \"file_id\": file_id,\n        \"expires_in\": 3600\n    }\n</code></pre>"},{"location":"api/s3-integration/#2-upload-do-frontend-javascript","title":"2. Upload do Frontend (JavaScript)","text":"<pre><code>// 1. Gerar file_id \u00fanico\nconst generateFileId = () =&gt; {\n  const timestamp = new Date().toISOString().split('T')[0].replace(/-/g, '_');\n  const random = Math.random().toString(36).substring(2, 8).toUpperCase();\n  return `${timestamp}_VIDEO_${random}`;\n};\n\n// 2. Obter presigned URL\nconst getUploadUrl = async (fileId) =&gt; {\n  const response = await fetch('/video/get-upload-url', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ file_id: fileId })\n  });\n  return await response.json();\n};\n\n// 3. Upload direto para S3\nconst uploadToS3 = async (file, uploadUrl) =&gt; {\n  const response = await fetch(uploadUrl, {\n    method: 'PUT',\n    body: file,\n    headers: {\n      'Content-Type': 'video/mp4'\n    }\n  });\n\n  if (!response.ok) {\n    throw new Error('Falha no upload para S3');\n  }\n};\n\n// 4. Iniciar an\u00e1lise\nconst analyzeFromS3 = async (fileId, options) =&gt; {\n  const response = await fetch('/video/analyze-from-s3', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      file_id: fileId,\n      ...options\n    })\n  });\n  return await response.json();\n};\n\n// Fluxo completo\nconst processVideo = async (videoFile) =&gt; {\n  try {\n    // 1. Gerar ID\n    const fileId = generateFileId();\n    console.log('File ID:', fileId);\n\n    // 2. Obter URL\n    const { upload_url } = await getUploadUrl(fileId);\n    console.log('Upload URL obtida');\n\n    // 3. Upload\n    await uploadToS3(videoFile, upload_url);\n    console.log(' Upload conclu\u00eddo!');\n\n    // 4. An\u00e1lise\n    const { task_id } = await analyzeFromS3(fileId, {\n      audience: ['millennials'],\n      platform_type: ['meta'],\n      language: 'pt'\n    });\n    console.log(' An\u00e1lise iniciada:', task_id);\n\n    return task_id;\n  } catch (error) {\n    console.error(' Erro:', error);\n    throw error;\n  }\n};\n</code></pre>"},{"location":"api/s3-integration/#3-upload-com-progress-react","title":"3. Upload com Progress (React)","text":"<pre><code>import { useState } from 'react';\n\nfunction VideoUploader() {\n  const [progress, setProgress] = useState(0);\n  const [taskId, setTaskId] = useState(null);\n\n  const handleUpload = async (file) =&gt; {\n    try {\n      // 1. Gerar file_id\n      const fileId = generateFileId();\n\n      // 2. Obter presigned URL\n      const { upload_url } = await getUploadUrl(fileId);\n\n      // 3. Upload com progress\n      const xhr = new XMLHttpRequest();\n\n      xhr.upload.addEventListener('progress', (e) =&gt; {\n        if (e.lengthComputable) {\n          const percentComplete = (e.loaded / e.total) * 100;\n          setProgress(Math.round(percentComplete));\n        }\n      });\n\n      xhr.addEventListener('load', async () =&gt; {\n        if (xhr.status === 200) {\n          console.log(' Upload S3 conclu\u00eddo');\n\n          // 4. Iniciar an\u00e1lise\n          const { task_id } = await analyzeFromS3(fileId, {\n            audience: ['millennials'],\n            platform_type: ['meta'],\n            language: 'pt'\n          });\n\n          setTaskId(task_id);\n        }\n      });\n\n      xhr.open('PUT', upload_url);\n      xhr.setRequestHeader('Content-Type', 'video/mp4');\n      xhr.send(file);\n\n    } catch (error) {\n      console.error('Erro:', error);\n    }\n  };\n\n  return (\n    &lt;div&gt;\n      &lt;input \n        type=\"file\" \n        accept=\"video/mp4\" \n        onChange={(e) =&gt; handleUpload(e.target.files[0])} \n      /&gt;\n      {progress &gt; 0 &amp;&amp; &lt;progress value={progress} max=\"100\" /&gt;}\n      {taskId &amp;&amp; &lt;p&gt;Task ID: {taskId}&lt;/p&gt;}\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"api/s3-integration/#seguranca","title":"Seguran\u00e7a","text":""},{"location":"api/s3-integration/#presigned-urls","title":"Presigned URLs","text":"<ul> <li>\u2705 Expira\u00e7\u00e3o: URLs expiram em 1 hora</li> <li>\u2705 Escopo limitado: Apenas PUT no caminho espec\u00edfico</li> <li>\u2705 Sem credenciais: Frontend n\u00e3o precisa de AWS credentials</li> </ul>"},{"location":"api/s3-integration/#validacao-de-file-id","title":"Valida\u00e7\u00e3o de File ID","text":"<pre><code>import re\n\ndef validate_file_id(file_id: str) -&gt; bool:\n    \"\"\"\n    Valida formato do file_id\n    \"\"\"\n    # Apenas alfanum\u00e9ricos, underscore e h\u00edfen\n    pattern = r'^[A-Za-z0-9_-]+$'\n\n    if not re.match(pattern, file_id):\n        raise ValueError(\"File ID inv\u00e1lido\")\n\n    if len(file_id) &gt; 100:\n        raise ValueError(\"File ID muito longo\")\n\n    return True\n</code></pre>"},{"location":"api/s3-integration/#performance","title":"Performance","text":""},{"location":"api/s3-integration/#comparacao-de-tempos","title":"Compara\u00e7\u00e3o de Tempos","text":"V\u00eddeo Tradicional S3 Economia 50MB ~30s ~10s 66% 100MB ~60s ~15s 75% 500MB ~5min ~45s 85%"},{"location":"api/s3-integration/#processamento-paralelo","title":"Processamento Paralelo","text":"<p>O backend usa ThreadPoolExecutor para processar em paralelo:</p> <pre><code>with concurrent.futures.ThreadPoolExecutor(max_workers=3) as executor:\n    future_upload = executor.submit(upload_to_gemini_task)\n    future_subtitles = executor.submit(process_subtitles_task)\n    future_aspect_ratio = executor.submit(process_aspect_ratio_task)\n\n    uploaded = future_upload.result()\n    subtitles = future_subtitles.result()\n    aspect_ratio = future_aspect_ratio.result()\n</code></pre>"},{"location":"api/s3-integration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"api/s3-integration/#erro-video-nao-encontrado-no-s3","title":"Erro: \"V\u00eddeo n\u00e3o encontrado no S3\"","text":"<p>Verificar: 1. File ID correto (sem espa\u00e7os ou caracteres especiais) 2. V\u00eddeo est\u00e1 em <code>mp4/</code> no bucket 3. Nome do bucket no <code>.env</code> est\u00e1 correto</p> <pre><code># Verificar via AWS CLI\naws s3 ls s3://test-bucket-video-klikeai/mp4/\n</code></pre>"},{"location":"api/s3-integration/#erro-access-denied","title":"Erro: \"Access Denied\"","text":"<p>Solu\u00e7\u00e3o: Verificar IAM policy do usu\u00e1rio:</p> <pre><code>{\n  \"Effect\": \"Allow\",\n  \"Action\": [\n    \"s3:GetObject\",\n    \"s3:PutObject\",\n    \"s3:ListBucket\"\n  ],\n  \"Resource\": [\n    \"arn:aws:s3:::test-bucket-video-klikeai\",\n    \"arn:aws:s3:::test-bucket-video-klikeai/*\"\n  ]\n}\n</code></pre>"},{"location":"api/s3-integration/#upload-lento-para-s3","title":"Upload lento para S3","text":"<p>Otimiza\u00e7\u00f5es: 1. Use multipart upload para v\u00eddeos &gt; 100MB 2. Configure Transfer Acceleration no bucket 3. Use regi\u00e3o S3 mais pr\u00f3xima do usu\u00e1rio</p>"},{"location":"api/s3-integration/#recursos-adicionais","title":"Recursos Adicionais","text":"<ul> <li>AWS S3 Presigned URLs</li> <li>Multipart Upload</li> <li>Transfer Acceleration</li> </ul> <p>Veja tamb\u00e9m:</p> <ul> <li>An\u00e1lise de V\u00eddeos</li> <li>Background Tasks</li> <li>Calculator API</li> </ul>"},{"location":"api/video-analysis/","title":"An\u00e1lise de V\u00eddeos","text":"<p>An\u00e1lise de V\u00eddeos</p> <p>Documenta\u00e7\u00e3o detalhada dos endpoints de an\u00e1lise de v\u00eddeos.</p>"},{"location":"api/video-analysis/#post-videoupload-video-async","title":"<code>POST /video/upload-video-async</code>","text":"<p>Upload e an\u00e1lise ass\u00edncrona de v\u00eddeo via API (multipart/form-data).</p>"},{"location":"api/video-analysis/#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>Upload direto de arquivo via API</li> <li>Processamento em background task</li> <li>Limite de 100MB por arquivo</li> <li>Retorna task_id para polling</li> <li>Suporta m\u00faltiplas audi\u00eancias e plataformas</li> </ul>"},{"location":"api/video-analysis/#request","title":"Request","text":"<p>Content-Type: <code>multipart/form-data</code></p> <p>Parameters:</p> Campo Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o <code>file</code> File Sim Arquivo de v\u00eddeo (MP4, AVI, MOV, etc.) <code>audience</code> Array N\u00e3o Lista de audi\u00eancias separadas por v\u00edrgula <code>platform_type</code> Array N\u00e3o Lista de plataformas separadas por v\u00edrgula <code>language</code> String N\u00e3o <code>pt</code> ou <code>en</code> (padr\u00e3o: <code>en</code>) <p>Formatos aceitos: MP4, AVI, MOV, MKV, WMV, FLV, WEBM</p> <p>Exemplo cURL:</p> <pre><code>curl -X POST \"http://localhost:8000/video/upload-video-async\" \\\n  -F \"file=@video.mp4\" \\\n  -F \"audience=millennials,genz\" \\\n  -F \"platform_type=meta,tiktok\" \\\n  -F \"language=pt\"\n</code></pre> <p>Exemplo Python:</p> <pre><code>import requests\n\nwith open('video.mp4', 'rb') as f:\n    response = requests.post(\n        'http://localhost:8000/video/upload-video-async',\n        files={'file': f},\n        data={\n            'audience': 'millennials,genz',\n            'platform_type': 'meta,tiktok',\n            'language': 'pt'\n        }\n    )\n\ntask_data = response.json()\nprint(f\"Task ID: {task_data['task_id']}\")\n</code></pre> <p>Exemplo JavaScript:</p> <pre><code>const formData = new FormData();\nformData.append('file', videoFile);\nformData.append('audience', 'millennials,genz');\nformData.append('platform_type', 'meta,tiktok');\nformData.append('language', 'pt');\n\nconst response = await fetch('http://localhost:8000/video/upload-video-async', {\n  method: 'POST',\n  body: formData\n});\n\nconst { task_id, check_status_url } = await response.json();\n</code></pre>"},{"location":"api/video-analysis/#response","title":"Response","text":"<p>Status: 200 OK</p> <pre><code>{\n  \"task_id\": \"8a72e48b-ca60-44d2-b126-a8dbb0500771\",\n  \"status\": \"accepted\",\n  \"message\": \"An\u00e1lise iniciada. Use o task_id para consultar o progresso.\",\n  \"check_status_url\": \"/video/task/8a72e48b-ca60-44d2-b126-a8dbb0500771\"\n}\n</code></pre> <p>Campos:</p> <ul> <li><code>task_id</code>: ID \u00fanico para consultar o progresso</li> <li><code>status</code>: Sempre \"accepted\" no retorno inicial</li> <li><code>message</code>: Mensagem descritiva</li> <li><code>check_status_url</code>: URL para consultar status</li> </ul>"},{"location":"api/video-analysis/#consultar-progresso","title":"Consultar Progresso","text":"<p>Use o endpoint <code>GET /video/task/{task_id}</code> para verificar o status:</p> <pre><code>curl \"http://localhost:8000/video/task/8a72e48b-ca60-44d2-b126-a8dbb0500771\"\n</code></pre> <p>Ver detalhes em Background Tasks.</p>"},{"location":"api/video-analysis/#erros-comuns","title":"Erros Comuns","text":"<p>400 Bad Request - Formato n\u00e3o suportado</p> <pre><code>{\n  \"detail\": \"Formato de v\u00eddeo n\u00e3o suportado\"\n}\n</code></pre> <p>Solu\u00e7\u00e3o: Use MP4, MOV, AVI, MKV, WMV, FLV ou WEBM.</p> <p>413 Payload Too Large</p> <pre><code>{\n  \"detail\": \"Arquivo muito grande. M\u00e1ximo: 100MB\"\n}\n</code></pre> <p>Solu\u00e7\u00e3o: Comprima o v\u00eddeo ou use integra\u00e7\u00e3o S3.</p> <p>500 Internal Server Error</p> <pre><code>{\n  \"detail\": \"Erro ao iniciar processamento: [detalhes]\"\n}\n</code></pre> <p>Solu\u00e7\u00e3o: Verifique os logs do servidor e tente novamente.</p>"},{"location":"api/video-analysis/#post-videoanalyze-from-s3","title":"<code>POST /video/analyze-from-s3</code>","text":"<p>An\u00e1lise de v\u00eddeo j\u00e1 armazenado no S3 (sem upload de bytes).</p>"},{"location":"api/video-analysis/#request_1","title":"Request","text":"<p>Parameters:</p> Campo Tipo Obrigat\u00f3rio Descri\u00e7\u00e3o <code>file</code> File Sim Arquivo MP4 (max 100MB) <code>audience</code> Array N\u00e3o Lista de audi\u00eancias <code>platform_type</code> Array N\u00e3o Lista de plataformas <code>language</code> String N\u00e3o <code>pt</code> ou <code>en</code> (padr\u00e3o: <code>en</code>) <p>Exemplo:</p> <pre><code>curl -X POST \"http://localhost:8000/video/analyze-from-s3\" \\\n  -F \"file=@video.mp4\" \\\n  -F \"audience=millennials\" \\\n  -F \"audience=genz\" \\\n  -F \"platform_type=meta\" \\\n  -F \"platform_type=tiktok\" \\\n  -F \"language=pt\"\n</code></pre>"},{"location":"api/video-analysis/#response_1","title":"Response","text":"<p>Status: 200 OK</p> <pre><code>{\n  \"task_id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"status\": \"accepted\",\n  \"message\": \"V\u00eddeo enviado para an\u00e1lise em background...\",\n  \"check_status_url\": \"/video/task/a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"file_name\": \"video.mp4\"\n}\n</code></pre>"},{"location":"api/video-analysis/#fluxo-de-processamento","title":"Fluxo de Processamento","text":"<pre><code>sequenceDiagram\n    participant C as Cliente\n    participant API as FastAPI\n    participant S3 as Temp Storage\n    participant G as Gemini AI\n    participant O as OpenAI\n\n    C-&gt;&gt;API: POST /analyze-from-s3\n    API-&gt;&gt;S3: Salvar temp file\n    API--&gt;&gt;C: task_id\n\n    Note over API: Background Task Inicia\n\n    API-&gt;&gt;G: Upload v\u00eddeo\n    G--&gt;&gt;API: file_uri\n\n    API-&gt;&gt;G: Aguardar ACTIVE\n    G--&gt;&gt;API: Status ACTIVE\n\n    par Processamento Paralelo\n        API-&gt;&gt;G: An\u00e1lise criativa\n        API-&gt;&gt;G: Guardrails\n        API-&gt;&gt;API: Processar legendas\n    end\n\n    G--&gt;&gt;API: Resultados\n\n    API-&gt;&gt;O: Gerar recomenda\u00e7\u00f5es\n    O--&gt;&gt;API: Actions\n\n    API-&gt;&gt;API: Calcular score final\n\n    Note over API: Task Status: completed\n\n    C-&gt;&gt;API: GET /task/{task_id}\n    API--&gt;&gt;C: Resultado completo</code></pre>"},{"location":"api/video-analysis/#progress-tracking","title":"Progress Tracking","text":"<p>O campo <code>progress</code> \u00e9 atualizado durante o processamento:</p> Progress Etapa 5% Upload para Gemini iniciado 20% Arquivo enviado 30% Aguardando processamento 40% An\u00e1lise de guardrails 55% Processamento de legendas 65% Montagem de prompts 85% An\u00e1lise com modelo 95% Gera\u00e7\u00e3o de actions 100% Conclu\u00eddo"},{"location":"api/video-analysis/#get-videotasktask_id","title":"<code>GET /video/task/{task_id}</code>","text":"<p>Consulta o status e resultado de uma tarefa de an\u00e1lise.</p>"},{"location":"api/video-analysis/#request_2","title":"Request","text":"<p>Path Parameters:</p> Campo Tipo Descri\u00e7\u00e3o <code>task_id</code> String (UUID) ID da tarefa <p>Exemplo:</p> <pre><code>curl \"http://localhost:8000/video/task/a1b2c3d4-e5f6-7890\"\n</code></pre>"},{"location":"api/video-analysis/#response-em-processamento","title":"Response - Em Processamento","text":"<p>Status: 200 OK</p> <pre><code>{\n  \"task_id\": \"a1b2c3d4-e5f6-7890\",\n  \"status\": \"processing\",\n  \"progress\": 65,\n  \"created_at\": \"2025-12-08T16:30:00\",\n  \"updated_at\": \"2025-12-08T16:31:30\",\n  \"file_name\": \"video.mp4\"\n}\n</code></pre>"},{"location":"api/video-analysis/#response-concluido","title":"Response - Conclu\u00eddo","text":"<p>Status: 200 OK</p> <pre><code>{\n  \"task_id\": \"a1b2c3d4-e5f6-7890\",\n  \"status\": \"completed\",\n  \"progress\": 100,\n  \"created_at\": \"2025-12-08T16:30:00\",\n  \"updated_at\": \"2025-12-08T16:32:45\",\n  \"file_name\": \"video.mp4\",\n  \"result\": {\n    \"message\": \"Video uploaded and analyzed successfully\",\n    \"file_name\": \"files/xyz123\",\n    \"analysis\": {\n      \"creative_metrics\": [...],\n      \"audience_scores\": {...},\n      \"platform_recommendations\": [...],\n      \"detected_issues\": {...}\n    },\n    \"score\": 75,\n    \"stage\": \"B\",\n    \"audiences_recommendations\": [...],\n    \"warning\": {...},\n    \"actions\": {\n      \"actions_creatives\": {...},\n      \"actions_issues\": {...},\n      \"actions_platforms\": {...},\n      \"actions_audiences\": {...}\n    }\n  }\n}\n</code></pre>"},{"location":"api/video-analysis/#response-falhou","title":"Response - Falhou","text":"<p>Status: 200 OK</p> <pre><code>{\n  \"task_id\": \"a1b2c3d4-e5f6-7890\",\n  \"status\": \"failed\",\n  \"progress\": 45,\n  \"created_at\": \"2025-12-08T16:30:00\",\n  \"updated_at\": \"2025-12-08T16:31:15\",\n  \"file_name\": \"video.mp4\",\n  \"error\": \"Erro durante o processamento: Timeout ao aguardar arquivo ficar ACTIVE\"\n}\n</code></pre>"},{"location":"api/video-analysis/#response-nao-encontrado","title":"Response - N\u00e3o Encontrado","text":"<p>Status: 404 Not Found</p> <pre><code>{\n  \"detail\": \"Tarefa n\u00e3o encontrada\"\n}\n</code></pre>"},{"location":"api/video-analysis/#get-videotasks","title":"<code>GET /video/tasks</code>","text":"<p>Lista todas as tarefas do usu\u00e1rio (\u00faltimas 24h).</p>"},{"location":"api/video-analysis/#request_3","title":"Request","text":"<pre><code>curl \"http://localhost:8000/video/tasks\"\n</code></pre>"},{"location":"api/video-analysis/#response_2","title":"Response","text":"<p>Status: 200 OK</p> <pre><code>{\n  \"tasks\": [\n    {\n      \"task_id\": \"a1b2c3d4-e5f6-7890\",\n      \"status\": \"completed\",\n      \"progress\": 100,\n      \"created_at\": \"2025-12-08T16:30:00\",\n      \"updated_at\": \"2025-12-08T16:32:45\",\n      \"file_name\": \"video1.mp4\"\n    },\n    {\n      \"task_id\": \"b2c3d4e5-f6g7-8901\",\n      \"status\": \"processing\",\n      \"progress\": 65,\n      \"created_at\": \"2025-12-08T16:35:00\",\n      \"updated_at\": \"2025-12-08T16:36:20\",\n      \"file_name\": \"video2.mp4\"\n    }\n  ],\n  \"total_tasks\": 2,\n  \"removed_old_tasks\": 3\n}\n</code></pre> <p>Nota: Tarefas com mais de 24h s\u00e3o automaticamente removidas.</p>"},{"location":"api/video-analysis/#estrutura-do-resultado","title":"Estrutura do Resultado","text":""},{"location":"api/video-analysis/#creative-metrics","title":"Creative Metrics","text":"<p>9 m\u00e9tricas que avaliam aspectos criativos:</p> <pre><code>{\n  \"metric_name\": \"3 Second Hook Score\",\n  \"score\": 85,\n  \"stage\": \"A\",\n  \"reasoning\": {\n    \"what_went_well\": [\n      \"Pergunta direta e instigante nos primeiros segundos\",\n      \"Visual atraente que captura aten\u00e7\u00e3o imediata\"\n    ],\n    \"room_for_improvement\": [\n      \"Poderia ter um elemento surpresa maior\",\n      \"Visual inicial um pouco gen\u00e9rico\"\n    ]\n  }\n}\n</code></pre> <p>M\u00e9tricas dispon\u00edveis:</p> <ol> <li>3 Second Hook Score</li> <li>Storytelling with Contrast Score</li> <li>Emotional Connection Score</li> <li>Music, Voice-over &amp; Subtitles Score</li> <li>Product or Service Focus Score</li> <li>Value Proposition Score</li> <li>CTA Score</li> <li>Community Score</li> <li>Video Resolution &amp; Quality Score</li> </ol>"},{"location":"api/video-analysis/#audience-scores","title":"Audience Scores","text":"<p>Pontua\u00e7\u00e3o para cada audi\u00eancia:</p> <pre><code>{\n  \"genz\": \"Gera\u00e7\u00e3o Z\",\n  \"score_genz\": 55,\n  \"reasoning_genz\": \"A alta qualidade de produ\u00e7\u00e3o pode parecer pouco aut\u00eantica...\",\n\n  \"millennials\": \"Millennials\",\n  \"score_millennials\": 88,\n  \"reasoning_millennials\": \"A mensagem de prop\u00f3sito e legado ressoa fortemente...\",\n\n  \"genx\": \"Gera\u00e7\u00e3o X\",\n  \"score_genx\": 85,\n  \"reasoning_genx\": \"A proposta de valor clara e qualidade profissional...\",\n\n  \"boomer\": \"Boomers\",\n  \"score_boomer\": 82,\n  \"reasoning_boomer\": \"A clareza da mensagem e reputa\u00e7\u00e3o da marca...\"\n}\n</code></pre>"},{"location":"api/video-analysis/#platform-recommendations","title":"Platform Recommendations","text":"<p>Recomenda\u00e7\u00f5es espec\u00edficas por plataforma:</p> <pre><code>{\n  \"platform\": \"meta\",\n  \"recommendations\": [\n    \"Incorpore uma narra\u00e7\u00e3o (voice-over) para complementar legendas\",\n    \"Teste vers\u00e3o com produto nos primeiros 3 segundos\",\n    \"Crie vers\u00e3o UGC com depoimentos reais\",\n    \"Adicione urg\u00eancia no CTA\"\n  ]\n}\n</code></pre>"},{"location":"api/video-analysis/#detected-issues","title":"Detected Issues","text":"<p>Issues t\u00e9cnicas com desconto no score:</p> <pre><code>{\n  \"safezone\": true,\n  \"details_safezone\": {\n    \"issue\": \"Elementos fora da safe zone vertical (1080x1920)\",\n    \"impact\": \"Elementos cruciais podem ser cortados pela UI\",\n    \"recommendation\": \"Manter elementos na \u00e1rea central 1080x1420px\",\n    \"discount_applied\": 10,\n    \"frames_example_urls\": [\n      \"https://supabase.co/storage/frames/frame_480.jpg\",\n      \"https://supabase.co/storage/frames/frame_570.jpg\"\n    ]\n  },\n  \"small_subtitles\": false,\n  \"fake_content\": false,\n  \"subtitle_position\": false,\n  \"guideline_compliance\": false,\n  \"hook_cta_char_limit\": true,\n  \"details_hook_cta_char_limit\": {\n    \"hook_violation\": {\n      \"has_violation\": true,\n      \"detected_length\": 65,\n      \"platforms\": [\"TikTok\"],\n      \"limit\": 60,\n      \"impact\": \"Hook pode ser truncado na exibi\u00e7\u00e3o\",\n      \"recommendation\": \"Reduza o Hook para at\u00e9 60 caracteres\"\n    },\n    \"cta_violation\": {\n      \"has_violation\": false\n    },\n    \"discount_applied\": 5\n  },\n  \"non_native_vertical_aspect_ratio_violation\": true,\n  \"details_non_native_vertical_aspect_ratio_violation\": {\n    \"issue\": \"V\u00eddeo horizontal em plataforma vertical (TikTok/Meta)\",\n    \"detected_aspect_ratio\": \"16:9\",\n    \"recommended_aspect_ratio\": \"9:16\",\n    \"impact\": \"Visualiza\u00e7\u00e3o reduzida em devices mobile\",\n    \"recommendation\": \"Grave ou edite em formato vertical 9:16\",\n    \"discount_applied\": 3,\n    \"frame_example_url\": \"https://supabase.co/storage/aspect-ratio/frame_example.jpg\"\n  }\n}\n</code></pre>"},{"location":"api/video-analysis/#actions","title":"Actions","text":"<p>A\u00e7\u00f5es espec\u00edficas geradas por IA:</p> <pre><code>{\n  \"actions_creatives\": {\n    \"action_storytelling_with_contrast_score\": [\n      \"Incluir cena visual clara do 'depois'\",\n      \"Adicionar gr\u00e1ficos que ilustrem o contraste\",\n      \"Usar depoimentos visuais de clientes\"\n    ],\n    \"action_cta_score\": [\n      \"Adicionar narra\u00e7\u00e3o que verbalize o CTA\",\n      \"Incluir senso de urg\u00eancia como 'tempo limitado'\"\n    ]\n  },\n  \"actions_issues\": {\n    \"action_safezone\": [\n      \"Mover elementos para zona segura central\",\n      \"Evitar colocar CTAs pr\u00f3ximo \u00e0s bordas\"\n    ]\n  },\n  \"actions_platforms\": {\n    \"action_meta\": [\n      \"Iniciar com logo da marca nos 3 primeiros segundos\",\n      \"Adicionar trilha sonora envolvente\",\n      \"Usar estilo UGC aut\u00eantico\"\n    ]\n  },\n  \"actions_audiences\": {\n    \"action_millennials\": [\n      \"Desenvolver v\u00eddeo com problema-solu\u00e7\u00e3o-resultado\",\n      \"Incluir depoimentos de clientes reais\",\n      \"Mostrar jornada do cliente\"\n    ]\n  }\n}\n</code></pre>"},{"location":"api/video-analysis/#erros-comuns_1","title":"Erros Comuns","text":""},{"location":"api/video-analysis/#413-payload-too-large","title":"413 Payload Too Large","text":"<pre><code>{\n  \"detail\": \"V\u00eddeo muito grande. M\u00e1ximo: 100MB\"\n}\n</code></pre> <p>Solu\u00e7\u00e3o: Comprima o v\u00eddeo ou use integra\u00e7\u00e3o S3.</p>"},{"location":"api/video-analysis/#422-unprocessable-entity","title":"422 Unprocessable Entity","text":"<pre><code>{\n  \"detail\": [\n    {\n      \"loc\": [\"body\", \"audience\"],\n      \"msg\": \"field required\",\n      \"type\": \"value_error.missing\"\n    }\n  ]\n}\n</code></pre> <p>Solu\u00e7\u00e3o: Verifique os campos obrigat\u00f3rios.</p>"},{"location":"api/video-analysis/#500-internal-server-error","title":"500 Internal Server Error","text":"<pre><code>{\n  \"detail\": \"Erro interno do servidor\"\n}\n</code></pre> <p>Solu\u00e7\u00e3o: Verifique logs do servidor e credenciais no <code>.env</code>.</p>"},{"location":"api/video-analysis/#boas-praticas","title":"Boas Pr\u00e1ticas","text":""},{"location":"api/video-analysis/#polling-inteligente","title":"Polling Inteligente","text":"<pre><code>import time\n\ndef wait_for_completion(task_id, max_wait=600):\n    \"\"\"\n    Aguarda conclus\u00e3o com backoff exponencial\n    \"\"\"\n    intervals = [2, 2, 3, 5, 5, 10, 10, 15, 20, 30]\n    elapsed = 0\n\n    for interval in intervals:\n        response = requests.get(f'/video/task/{task_id}')\n        data = response.json()\n\n        if data['status'] in ['completed', 'failed']:\n            return data\n\n        time.sleep(interval)\n        elapsed += interval\n\n        if elapsed &gt;= max_wait:\n            raise TimeoutError(\"An\u00e1lise excedeu tempo m\u00e1ximo\")\n\n    return data\n</code></pre>"},{"location":"api/video-analysis/#timeout-handling","title":"Timeout Handling","text":"<pre><code>const analyzeWithTimeout = async (videoFile, timeout = 600000) =&gt; {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() =&gt; controller.abort(), timeout);\n\n  try {\n    const result = await analyzeVideo(videoFile, {\n      signal: controller.signal\n    });\n    clearTimeout(timeoutId);\n    return result;\n  } catch (error) {\n    if (error.name === 'AbortError') {\n      throw new Error('An\u00e1lise excedeu tempo limite');\n    }\n    throw error;\n  }\n};\n</code></pre> <p>Veja tamb\u00e9m:</p> <ul> <li>Integra\u00e7\u00e3o S3 para uploads maiores</li> <li>Background Tasks para detalhes t\u00e9cnicos</li> <li>Calculator API para estimativas de budget</li> </ul>"},{"location":"architecture/data-flow/","title":"Fluxo de Dados","text":""},{"location":"architecture/data-flow/#fluxo-de-dados","title":"Fluxo de Dados","text":"<p>Documenta\u00e7\u00e3o detalhada sobre como os dados fluem atrav\u00e9s do sistema Klike AI Services em diferentes cen\u00e1rios.</p>"},{"location":"architecture/data-flow/#visao-geral","title":"\ud83c\udfaf Vis\u00e3o Geral","text":"<p>O sistema processa dados em m\u00faltiplos est\u00e1gios:</p> <ol> <li>Ingest\u00e3o: Recep\u00e7\u00e3o de v\u00eddeos e metadados</li> <li>Armazenamento: Persist\u00eancia em S3 e banco de dados</li> <li>Processamento: Extra\u00e7\u00e3o, transcri\u00e7\u00e3o e an\u00e1lise</li> <li>Entrega: Retorno de resultados ao cliente</li> </ol>"},{"location":"architecture/data-flow/#fluxo-de-upload","title":"\ud83d\udce5 Fluxo de Upload","text":""},{"location":"architecture/data-flow/#upload-direto-para-s3-recomendado","title":"Upload Direto para S3 (Recomendado)","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant API\n    participant S3\n    participant DB\n\n    Client-&gt;&gt;API: POST /api/v1/videos/upload-url\n    Note over API: Gera presigned URL\n    API-&gt;&gt;S3: Generate presigned URL\n    S3--&gt;&gt;API: Presigned URL (v\u00e1lida por 1h)\n    API-&gt;&gt;DB: Create video record (status: pending_upload)\n    API--&gt;&gt;Client: {upload_url, video_id}\n\n    Client-&gt;&gt;S3: PUT {upload_url} + video file\n    S3--&gt;&gt;Client: 200 OK\n\n    Client-&gt;&gt;API: POST /api/v1/videos/{video_id}/confirm\n    API-&gt;&gt;S3: Verify file exists\n    S3--&gt;&gt;API: File metadata\n    API-&gt;&gt;DB: Update status: uploaded\n    API--&gt;&gt;Client: {video_id, status: uploaded}</code></pre> <p>Vantagens:</p> <ul> <li>\u2705 Sem limite de tamanho de arquivo na API</li> <li>\u2705 Upload mais r\u00e1pido (direto ao S3)</li> <li>\u2705 Menor carga no servidor API</li> <li>\u2705 Progresso de upload no cliente</li> </ul>"},{"location":"architecture/data-flow/#upload-via-api-alternativo","title":"Upload via API (Alternativo)","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant API\n    participant S3\n    participant DB\n\n    Client-&gt;&gt;API: POST /api/v1/videos/upload&lt;br/&gt;(multipart/form-data)\n    Note over API: Recebe v\u00eddeo\n    API-&gt;&gt;API: Validate video\n    API-&gt;&gt;S3: Upload video\n    S3--&gt;&gt;API: S3 URL\n    API-&gt;&gt;DB: Create record\n    API--&gt;&gt;Client: {video_id, s3_url}</code></pre> <p>Limita\u00e7\u00f5es:</p> <ul> <li>\u26a0\ufe0f Limite de 100MB por requisi\u00e7\u00e3o</li> <li>\u26a0\ufe0f Timeout ap\u00f3s 5 minutos</li> <li>\u26a0\ufe0f Maior carga no servidor</li> </ul>"},{"location":"architecture/data-flow/#fluxo-de-processamento","title":"\ud83d\udd04 Fluxo de Processamento","text":""},{"location":"architecture/data-flow/#pipeline-completo","title":"Pipeline Completo","text":"<pre><code>graph TB\n    Start([V\u00eddeo Uploaded])\n    Queue[Enfileirar Task]\n    Assign[Atribuir ao Worker]\n\n    Download[Download do S3]\n    ValidateVideo[Validar V\u00eddeo]\n    ExtractMeta[Extrair Metadados]\n\n    ExtractAudio[Extrair \u00c1udio]\n    UploadAudio[Upload \u00c1udio para S3]\n\n    Transcribe[Transcrever com Whisper]\n\n    AnalyzeContent[Analisar Conte\u00fado - Gemini]\n    CalculateScore[Calcular Scores]\n    DetectIssues[Detectar Issues]\n\n    GenerateRecs[Gerar Recomenda\u00e7\u00f5es]\n\n    SaveResults[Salvar Resultados no DB]\n    UpdateStatus[Atualizar Status]\n\n    Complete([Task Completed])\n    Failed([Task Failed])\n\n    Start --&gt; Queue\n    Queue --&gt; Assign\n    Assign --&gt; Download\n\n    Download --&gt; ValidateVideo\n    ValidateVideo --&gt;|V\u00e1lido| ExtractMeta\n    ValidateVideo --&gt;|Inv\u00e1lido| Failed\n\n    ExtractMeta --&gt; ExtractAudio\n    ExtractAudio --&gt; UploadAudio\n    UploadAudio --&gt; Transcribe\n\n    Transcribe --&gt; AnalyzeContent\n    AnalyzeContent --&gt; CalculateScore\n    CalculateScore --&gt; DetectIssues\n\n    DetectIssues --&gt; GenerateRecs\n    GenerateRecs --&gt; SaveResults\n    SaveResults --&gt; UpdateStatus\n    UpdateStatus --&gt; Complete\n\n    Download -.-&gt;|Erro| Failed\n    ExtractAudio -.-&gt;|Erro| Failed\n    Transcribe -.-&gt;|Erro| Failed\n    AnalyzeContent -.-&gt;|Erro| Failed\n\n    style Start fill:#4CAF50\n    style Complete fill:#4CAF50\n    style Failed fill:#F44336</code></pre>"},{"location":"architecture/data-flow/#etapas-detalhadas","title":"Etapas Detalhadas","text":""},{"location":"architecture/data-flow/#1-download-e-validacao","title":"1. Download e Valida\u00e7\u00e3o","text":"<p>Entrada:</p> <ul> <li><code>video_id</code>: UUID do v\u00eddeo</li> <li><code>s3_url</code>: URL no S3</li> </ul> <p>Processamento:</p> <pre><code># Download do S3\nvideo_data = s3_client.download(s3_url)\n\n# Valida\u00e7\u00f5es\nvalidations = {\n    \"format\": check_format(video_data),      # MP4, MOV, AVI\n    \"duration\": check_duration(video_data),  # 5s - 300s\n    \"size\": check_size(video_data),          # &lt; 500MB\n    \"codec\": check_codec(video_data),        # H.264, H.265\n    \"resolution\": check_resolution(video_data) # &gt;= 720p\n}\n</code></pre> <p>Sa\u00edda:</p> <pre><code>{\n  \"valid\": true,\n  \"metadata\": {\n    \"format\": \"mp4\",\n    \"duration\": 30.5,\n    \"size_mb\": 45.2,\n    \"codec\": \"h264\",\n    \"resolution\": \"1920x1080\",\n    \"fps\": 30,\n    \"bitrate\": 12000000\n  }\n}\n</code></pre>"},{"location":"architecture/data-flow/#2-extracao-de-audio","title":"2. Extra\u00e7\u00e3o de \u00c1udio","text":"<p>Entrada:</p> <ul> <li>Arquivo de v\u00eddeo</li> </ul> <p>Processamento:</p> <pre><code># FFmpeg command\nffmpeg -i input.mp4 \\\n  -vn \\                      # Sem v\u00eddeo\n  -acodec libmp3lame \\       # Codec MP3\n  -ab 192k \\                 # Bitrate 192kbps\n  -ar 44100 \\                # Sample rate\n  -y \\                       # Sobrescrever\n  output.mp3\n</code></pre> <p>Sa\u00edda:</p> <ul> <li>Arquivo de \u00e1udio MP3</li> <li>Dura\u00e7\u00e3o id\u00eantica ao v\u00eddeo</li> <li>Tamanho ~3-5% do v\u00eddeo original</li> </ul>"},{"location":"architecture/data-flow/#3-transcricao","title":"3. Transcri\u00e7\u00e3o","text":"<p>Entrada:</p> <ul> <li>Arquivo de \u00e1udio MP3</li> </ul> <p>Processamento:</p> <pre><code># OpenAI Whisper API\nwith open(\"audio.mp3\", \"rb\") as audio_file:\n    transcript = openai.Audio.transcribe(\n        model=\"whisper-1\",\n        file=audio_file,\n        language=\"pt\",  # Auto-detectado se omitido\n        response_format=\"verbose_json\"\n    )\n</code></pre> <p>Sa\u00edda:</p> <pre><code>{\n  \"text\": \"Descubra o novo produto revolucion\u00e1rio...\",\n  \"language\": \"pt\",\n  \"duration\": 30.5,\n  \"segments\": [\n    {\n      \"id\": 0,\n      \"start\": 0.0,\n      \"end\": 3.5,\n      \"text\": \"Descubra o novo produto revolucion\u00e1rio\",\n      \"confidence\": 0.95\n    },\n    {\n      \"id\": 1,\n      \"start\": 3.5,\n      \"end\": 7.2,\n      \"text\": \"que vai transformar sua vida\",\n      \"confidence\": 0.93\n    }\n  ]\n}\n</code></pre>"},{"location":"architecture/data-flow/#4-analise-com-ia","title":"4. An\u00e1lise com IA","text":"<p>Entrada:</p> <pre><code>analysis_input = {\n    \"transcript\": \"Descubra o novo produto...\",\n    \"video_metadata\": {\n        \"duration\": 30.5,\n        \"resolution\": \"1920x1080\",\n        \"has_audio\": True\n    },\n    \"context\": {\n        \"audience\": \"jovens_adultos\",\n        \"platform\": \"instagram\",\n        \"objective\": \"awareness\"\n    }\n}\n</code></pre> <p>Processamento:</p> <pre><code># Construir prompt\nprompt = build_analysis_prompt(\n    transcript=analysis_input[\"transcript\"],\n    metadata=analysis_input[\"video_metadata\"],\n    context=analysis_input[\"context\"]\n)\n\n# Chamar Gemini\nresponse = gemini.generate_content(\n    prompt=prompt,\n    model=\"gemini-pro\",\n    temperature=0.7\n)\n\n# Parse response\nanalysis = parse_gemini_response(response.text)\n</code></pre> <p>Sa\u00edda:</p> <pre><code>{\n  \"creative_score\": {\n    \"hook_score\": 8.5,\n    \"message_clarity\": 9.0,\n    \"visual_appeal\": 8.0,\n    \"audio_quality\": 7.5,\n    \"call_to_action\": 8.0\n  },\n  \"detected_issues\": [\n    {\n      \"type\": \"visual\",\n      \"severity\": \"medium\",\n      \"description\": \"Texto muito pequeno nos primeiros 3 segundos\",\n      \"timestamp\": 2.5,\n      \"suggestion\": \"Aumentar tamanho da fonte para 48pt ou maior\"\n    }\n  ],\n  \"strengths\": [\n    \"Hook forte nos primeiros 3 segundos\",\n    \"Mensagem clara e direta\",\n    \"CTA bem posicionado\"\n  ],\n  \"weaknesses\": [\n    \"Ritmo pode ser mais din\u00e2mico\",\n    \"Falta urg\u00eancia no CTA\"\n  ]\n}\n</code></pre>"},{"location":"architecture/data-flow/#5-deteccao-de-issues-e-desconto-de-score","title":"5. Detec\u00e7\u00e3o de Issues e Desconto de Score","text":"<p>Issues T\u00e9cnicas Detectadas:</p> <p>O sistema realiza valida\u00e7\u00f5es t\u00e9cnicas paralelas ao processamento:</p> <p>A) Valida\u00e7\u00e3o de Safe Zone</p> <pre><code># Processar legendas e verificar safe zone\nsubtitles_result = process_video_subtitles(video_path, is_vertical_format)\n\n# Estrutura retornada\n{\n    \"subtitles_text\": \"Transcri\u00e7\u00e3o completa...\",\n    \"has_safezone_violation\": True,\n    \"frames_example_urls\": [\n        \"https://supabase.co/storage/safezone/frame_480.jpg\",\n        \"https://supabase.co/storage/safezone/frame_570.jpg\"\n    ]\n}\n</code></pre> <p>B) Valida\u00e7\u00e3o de Aspect Ratio</p> <pre><code># Detectar viola\u00e7\u00e3o de aspect ratio\nis_vertical = video_metadata['height'] &gt; video_metadata['width']\nplatforms = ['TikTok', 'Meta']\n\nnon_native_violation = False\n\n# V\u00eddeo horizontal em plataforma vertical\nif not is_vertical and any(p.lower() in ['tiktok', 'meta'] for p in platforms):\n    non_native_violation = True\n    # Processar frame de exemplo\n    aspect_ratio_frame_url = process_aspect_ratio_violation(video_path, video_name)\n\n# V\u00eddeo vertical apenas em LinkedIn\nelif is_vertical and all(p.lower() == 'linkedin' for p in platforms):\n    non_native_violation = True\n</code></pre> <p>C) Valida\u00e7\u00e3o de Hook/CTA</p> <pre><code>hook = response['hook']\ncta = response['cta']\n\n# Limites por plataforma\nlimits = {\n    'tiktok': {'hook': 60, 'cta': 30},\n    'meta': {'hook': 80, 'cta': 40},\n    'linkedin': {'hook': 100, 'cta': 50},\n    'youtube': {'hook': None, 'cta': 50}\n}\n\nhook_cta_violations = check_hook_cta_char_violations(hook, cta, platforms)\n</code></pre> <p>D) C\u00e1lculo de Score com Descontos</p> <pre><code># Score inicial calculado pelos creative metrics\ninitial_score = calculate_score(response_json)  # Ex: 8.5\n\n# Aplicar descontos por issues\ndiscount_result = descont_score(\n    response_json,\n    initial_score,\n    subtitles_text_and_safezone,\n    non_native_vertical_aspect_ratio_violation,\n    aspect_ratio_frame_url,\n    hook_cta_violations,\n    language\n)\n\n# Resultado\n{\n    \"initial_score\": 8.5,\n    \"final_score\": 6.0,\n    \"total_discount\": 2.5,\n    \"detected_issues\": {\n        \"safezone\": True,\n        \"details_safezone\": {...},\n        \"hook_cta_char_limit\": True,\n        \"details_hook_cta_char_limit\": {...}\n    }\n}\n</code></pre> <p>Tabela de Descontos:</p> Issue Desconto Gatilho small_subtitles -4 pontos Legendas &lt; 24px fake_content -10 pontos Conte\u00fado enganoso detectado subtitle_position -8 pontos Legendas mal posicionadas guideline_compliance -12 pontos Viola diretrizes da plataforma safezone -10 pontos Elementos fora da \u00e1rea segura hook_cta_char_limit -5 pontos Hook/CTA excede limite non_native_vertical_aspect_ratio_violation -3 pontos Aspect ratio inadequado"},{"location":"architecture/data-flow/#6-geracao-de-recomendacoes","title":"6. Gera\u00e7\u00e3o de Recomenda\u00e7\u00f5es","text":"<p>Entrada:</p> <ul> <li>An\u00e1lise da IA</li> <li>Scores calculados (inicial e final)</li> <li>Issues detectadas com detalhes</li> </ul> <p>Processamento:</p> <pre><code>recommendations = []\n\n# Baseado em scores baixos\nif creative_score.hook_score &lt; 7:\n    recommendations.append({\n        \"type\": \"improvement\",\n        \"priority\": \"high\",\n        \"category\": \"hook\",\n        \"title\": \"Melhorar gancho inicial\",\n        \"description\": \"Considere usar uma pergunta provocativa ou estat\u00edstica impactante nos primeiros 3 segundos\",\n        \"examples\": [\n            \"Voc\u00ea sabia que 80% das pessoas...\",\n            \"E se eu te contar um segredo...\"\n        ]\n    })\n\n# Baseado em issues\nfor issue in detected_issues:\n    if issue[\"severity\"] == \"high\":\n        recommendations.append(\n            generate_fix_recommendation(issue)\n        )\n\n# Baseado em melhores pr\u00e1ticas\nplatform_best_practices = get_best_practices(platform)\nrecommendations.extend(platform_best_practices)\n</code></pre> <p>Sa\u00edda:</p> <pre><code>{\n  \"recommendations\": [\n    {\n      \"type\": \"improvement\",\n      \"priority\": \"high\",\n      \"category\": \"hook\",\n      \"title\": \"Fortalecer gancho inicial\",\n      \"description\": \"Os primeiros 3 segundos s\u00e3o cruciais. Adicione um elemento de surpresa ou curiosidade.\",\n      \"impact\": \"Pode aumentar reten\u00e7\u00e3o em at\u00e9 30%\",\n      \"effort\": \"medium\",\n      \"examples\": [\n        \"Use uma pergunta provocativa\",\n        \"Mostre o resultado final primeiro\",\n        \"Adicione um fato surpreendente\"\n      ]\n    },\n    {\n      \"type\": \"fix\",\n      \"priority\": \"medium\",\n      \"category\": \"visual\",\n      \"title\": \"Ajustar tamanho do texto\",\n      \"description\": \"Textos devem ter no m\u00ednimo 48pt para legibilidade em mobile\",\n      \"impact\": \"Melhora legibilidade em 50%\",\n      \"effort\": \"low\",\n      \"technical_details\": {\n        \"current_size\": \"32pt\",\n        \"recommended_size\": \"48-72pt\",\n        \"affected_timestamps\": [2.5, 8.3, 15.7]\n      }\n    }\n  ],\n  \"total_recommendations\": 8,\n  \"estimated_improvement\": \"+25% performance\"\n}\n</code></pre>"},{"location":"architecture/data-flow/#fluxo-de-dados-no-banco","title":"\ud83d\udcca Fluxo de Dados no Banco","text":""},{"location":"architecture/data-flow/#estrutura-de-tabelas","title":"Estrutura de Tabelas","text":"<pre><code>-- Videos\nvideos\n\u251c\u2500\u2500 id (uuid, PK)\n\u251c\u2500\u2500 user_id (uuid, FK)\n\u251c\u2500\u2500 title (text)\n\u251c\u2500\u2500 s3_url (text)\n\u251c\u2500\u2500 status (enum: pending, uploaded, processing, completed, failed)\n\u251c\u2500\u2500 created_at (timestamp)\n\u2514\u2500\u2500 updated_at (timestamp)\n\n-- Tasks\ntasks\n\u251c\u2500\u2500 id (uuid, PK)\n\u251c\u2500\u2500 video_id (uuid, FK)\n\u251c\u2500\u2500 status (enum: queued, processing, completed, failed)\n\u251c\u2500\u2500 progress (integer 0-100)\n\u251c\u2500\u2500 error_message (text, nullable)\n\u251c\u2500\u2500 created_at (timestamp)\n\u2514\u2500\u2500 updated_at (timestamp)\n\n-- Analysis Results\nanalysis_results\n\u251c\u2500\u2500 id (uuid, PK)\n\u251c\u2500\u2500 video_id (uuid, FK)\n\u251c\u2500\u2500 creative_score (jsonb)\n\u251c\u2500\u2500 detected_issues (jsonb)\n\u251c\u2500\u2500 recommendations (jsonb)\n\u251c\u2500\u2500 transcript (text)\n\u251c\u2500\u2500 metadata (jsonb)\n\u2514\u2500\u2500 created_at (timestamp)\n</code></pre>"},{"location":"architecture/data-flow/#ciclo-de-vida-dos-dados","title":"Ciclo de Vida dos Dados","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; PendingUpload: Create video\n    PendingUpload --&gt; Uploaded: Confirm upload\n    Uploaded --&gt; Queued: Request analysis\n    Queued --&gt; Processing: Worker starts\n\n    Processing --&gt; ExtractingAudio\n    ExtractingAudio --&gt; Transcribing\n    Transcribing --&gt; Analyzing\n    Analyzing --&gt; Completed\n\n    Processing --&gt; Failed: Error\n    ExtractingAudio --&gt; Failed: Error\n    Transcribing --&gt; Failed: Error\n    Analyzing --&gt; Failed: Error\n\n    Completed --&gt; [*]\n    Failed --&gt; [*]</code></pre>"},{"location":"architecture/data-flow/#fluxo-de-cache","title":"\ud83d\udd04 Fluxo de Cache","text":""},{"location":"architecture/data-flow/#estrategia-de-cache","title":"Estrat\u00e9gia de Cache","text":"<pre><code># Cache em m\u00faltiplas camadas\ncache_layers = {\n    \"L1_Memory\": {\n        \"location\": \"Application memory\",\n        \"ttl\": \"5 minutes\",\n        \"data\": [\"frequent queries\", \"user sessions\"]\n    },\n    \"L2_Redis\": {\n        \"location\": \"Redis cluster\",\n        \"ttl\": \"1 hour\",\n        \"data\": [\"analysis results\", \"transcripts\"]\n    },\n    \"L3_S3\": {\n        \"location\": \"S3 bucket\",\n        \"ttl\": \"30 days\",\n        \"data\": [\"processed videos\", \"audio files\"]\n    }\n}\n</code></pre>"},{"location":"architecture/data-flow/#invalidacao-de-cache","title":"Invalida\u00e7\u00e3o de Cache","text":"<pre><code># Quando invalidar cache\ninvalidate_cache_on = [\n    \"video_reanalyzed\",\n    \"user_deleted_video\",\n    \"analysis_updated\",\n    \"ttl_expired\"\n]\n</code></pre>"},{"location":"architecture/data-flow/#metricas-de-fluxo","title":"\ud83d\udcc8 M\u00e9tricas de Fluxo","text":""},{"location":"architecture/data-flow/#throughput","title":"Throughput","text":"Etapa Tempo M\u00e9dio Throughput Upload (S3 direct) 5-30s 100 videos/min Download 2-10s 200 videos/min Extra\u00e7\u00e3o de \u00e1udio 3-8s 150 videos/min Transcri\u00e7\u00e3o 10-30s 50 videos/min An\u00e1lise IA 20-60s 30 videos/min Total 40-130s 30 videos/min"},{"location":"architecture/data-flow/#gargalos-identificados","title":"Gargalos Identificados","text":"<ol> <li>Transcri\u00e7\u00e3o: Limitado por API do Whisper</li> <li>An\u00e1lise IA: Limitado por rate limit do Gemini</li> <li>Download: Dependente de lat\u00eancia de rede</li> </ol>"},{"location":"architecture/data-flow/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Servi\u00e7os - Detalhes de implementa\u00e7\u00e3o de cada servi\u00e7o</li> <li>Integra\u00e7\u00f5es - Como integramos com servi\u00e7os externos</li> <li>Vis\u00e3o Geral da Arquitetura - Entenda a arquitetura completa do sistema</li> </ul>"},{"location":"architecture/integrations/","title":"Integra\u00e7\u00f5es","text":""},{"location":"architecture/integrations/#integracoes-externas","title":"Integra\u00e7\u00f5es Externas","text":"<p>Documenta\u00e7\u00e3o das integra\u00e7\u00f5es com servi\u00e7os externos utilizados pelo Klike AI Services.</p>"},{"location":"architecture/integrations/#visao-geral","title":"\ud83c\udfaf Vis\u00e3o Geral","text":"<p>O sistema integra com diversos servi\u00e7os externos para fornecer funcionalidades completas:</p> <pre><code>graph TB\n    API[Klike AI Services]\n\n    Gemini[Google Gemini API]\n    Whisper[OpenAI Whisper API]\n    S3[AWS S3]\n    Supabase[Supabase PostgreSQL]\n\n    API --&gt;|An\u00e1lise de Conte\u00fado| Gemini\n    API --&gt;|Transcri\u00e7\u00e3o de \u00c1udio| Whisper\n    API --&gt;|Armazenamento de V\u00eddeos| S3\n    API --&gt;|Persist\u00eancia de Dados| Supabase\n\n    style Gemini fill:#4285F4\n    style Whisper fill:#00A67E\n    style S3 fill:#FF9900\n    style Supabase fill:#3ECF8E</code></pre>"},{"location":"architecture/integrations/#google-gemini-api","title":"\ud83e\udd16 Google Gemini API","text":""},{"location":"architecture/integrations/#proposito","title":"Prop\u00f3sito","text":"<p>An\u00e1lise inteligente de conte\u00fado criativo usando IA generativa de \u00faltima gera\u00e7\u00e3o.</p>"},{"location":"architecture/integrations/#configuracao","title":"Configura\u00e7\u00e3o","text":"<pre><code># .env\nGOOGLE_GEMINI_API_KEY=your_api_key_here\n</code></pre>"},{"location":"architecture/integrations/#cliente","title":"Cliente","text":"<pre><code>import google.generativeai as genai\n\ngenai.configure(api_key=os.getenv(\"GOOGLE_GEMINI_API_KEY\"))\n\nmodel = genai.GenerativeModel('gemini-pro')\n</code></pre>"},{"location":"architecture/integrations/#uso-no-sistema","title":"Uso no Sistema","text":""},{"location":"architecture/integrations/#analise-de-criatividade","title":"An\u00e1lise de Criatividade","text":"<pre><code>def analyze_creative_content(transcript: str, metadata: dict) -&gt; dict:\n    prompt = f\"\"\"\n    Analise este v\u00eddeo publicit\u00e1rio:\n\n    Transcri\u00e7\u00e3o: {transcript}\n    Dura\u00e7\u00e3o: {metadata['duration']}s\n\n    Avalie:\n    1. Hook (0-10)\n    2. Clareza da mensagem (0-10)\n    3. Apelo visual estimado (0-10)\n    4. Call-to-action (0-10)\n\n    Identifique issues e sugira melhorias.\n\n    Responda em JSON.\n    \"\"\"\n\n    response = model.generate_content(prompt)\n    return parse_json_response(response.text)\n</code></pre>"},{"location":"architecture/integrations/#deteccao-de-issues","title":"Detec\u00e7\u00e3o de Issues","text":"<pre><code>def detect_issues(transcript: str, context: dict) -&gt; list:\n    prompt = f\"\"\"\n    Identifique problemas neste v\u00eddeo para {context['platform']}:\n\n    {transcript}\n\n    Procure por:\n    - Mensagem confusa\n    - CTA ausente ou fraco\n    - Ritmo inadequado\n    - Viola\u00e7\u00f5es de pol\u00edticas\n\n    Para cada issue, forne\u00e7a:\n    - Tipo\n    - Severidade (low/medium/high)\n    - Descri\u00e7\u00e3o\n    - Sugest\u00e3o de corre\u00e7\u00e3o\n    \"\"\"\n\n    response = model.generate_content(prompt)\n    return parse_issues(response.text)\n</code></pre>"},{"location":"architecture/integrations/#limites-e-quotas","title":"Limites e Quotas","text":"Tier Requisi\u00e7\u00f5es/min Requisi\u00e7\u00f5es/dia Tokens/min Free 15 1,500 32,000 Pay-as-you-go 360 Ilimitado 4,000,000"},{"location":"architecture/integrations/#tratamento-de-erros","title":"Tratamento de Erros","text":"<pre><code>from google.api_core import exceptions\n\ntry:\n    response = model.generate_content(prompt)\nexcept exceptions.ResourceExhausted:\n    # Rate limit excedido\n    retry_after = 60\n    time.sleep(retry_after)\nexcept exceptions.InvalidArgument:\n    # Prompt inv\u00e1lido\n    logger.error(\"Invalid prompt\")\nexcept exceptions.DeadlineExceeded:\n    # Timeout\n    logger.error(\"Request timeout\")\n</code></pre>"},{"location":"architecture/integrations/#melhores-praticas","title":"Melhores Pr\u00e1ticas","text":"<ul> <li>\u2705 Use temperatura 0.7 para balan\u00e7o entre criatividade e consist\u00eancia</li> <li>\u2705 Implemente retry com exponential backoff</li> <li>\u2705 Cache respostas para prompts similares</li> <li>\u2705 Monitore uso de tokens para otimizar custos</li> <li>\u2705 Use prompt engineering para respostas estruturadas</li> </ul>"},{"location":"architecture/integrations/#openai-whisper-api","title":"\ud83c\udf99\ufe0f OpenAI Whisper API","text":""},{"location":"architecture/integrations/#proposito_1","title":"Prop\u00f3sito","text":"<p>Transcri\u00e7\u00e3o precisa de \u00e1udio em m\u00faltiplos idiomas.</p>"},{"location":"architecture/integrations/#configuracao_1","title":"Configura\u00e7\u00e3o","text":"<pre><code># .env\nOPENAI_API_KEY=your_api_key_here\n</code></pre>"},{"location":"architecture/integrations/#cliente_1","title":"Cliente","text":"<pre><code>from openai import OpenAI\n\nclient = OpenAI(api_key=os.getenv(\"OPENAI_API_KEY\"))\n</code></pre>"},{"location":"architecture/integrations/#uso-no-sistema_1","title":"Uso no Sistema","text":""},{"location":"architecture/integrations/#transcricao-basica","title":"Transcri\u00e7\u00e3o B\u00e1sica","text":"<pre><code>def transcribe_audio(audio_file_path: str) -&gt; dict:\n    with open(audio_file_path, \"rb\") as audio_file:\n        transcript = client.audio.transcriptions.create(\n            model=\"whisper-1\",\n            file=audio_file,\n            language=\"pt\",  # Opcional, auto-detecta se omitido\n            response_format=\"verbose_json\"\n        )\n\n    return {\n        \"text\": transcript.text,\n        \"language\": transcript.language,\n        \"duration\": transcript.duration,\n        \"segments\": transcript.segments\n    }\n</code></pre>"},{"location":"architecture/integrations/#transcricao-com-timestamps","title":"Transcri\u00e7\u00e3o com Timestamps","text":"<pre><code>def transcribe_with_timestamps(audio_path: str) -&gt; list:\n    transcript = client.audio.transcriptions.create(\n        model=\"whisper-1\",\n        file=open(audio_path, \"rb\"),\n        response_format=\"verbose_json\",\n        timestamp_granularities=[\"segment\", \"word\"]\n    )\n\n    segments = []\n    for segment in transcript.segments:\n        segments.append({\n            \"start\": segment.start,\n            \"end\": segment.end,\n            \"text\": segment.text,\n            \"confidence\": segment.confidence\n        })\n\n    return segments\n</code></pre>"},{"location":"architecture/integrations/#idiomas-suportados","title":"Idiomas Suportados","text":"Idioma C\u00f3digo Qualidade Portugu\u00eas pt Excelente Ingl\u00eas en Excelente Espanhol es Excelente Franc\u00eas fr Muito Boa Alem\u00e3o de Muito Boa +90 idiomas ... Vari\u00e1vel"},{"location":"architecture/integrations/#limites-e-quotas_1","title":"Limites e Quotas","text":"Plano Tamanho M\u00e1x. Custo (por minuto) Whisper-1 25 MB $0.006"},{"location":"architecture/integrations/#otimizacoes","title":"Otimiza\u00e7\u00f5es","text":"<pre><code>def optimize_audio_for_transcription(video_path: str) -&gt; str:\n    \"\"\"\n    Otimiza \u00e1udio antes da transcri\u00e7\u00e3o:\n    - Remove v\u00eddeo\n    - Converte para MP3\n    - Reduz bitrate\n    - Normaliza volume\n    \"\"\"\n    output_path = \"optimized_audio.mp3\"\n\n    ffmpeg.input(video_path) \\\n        .output(\n            output_path,\n            acodec='libmp3lame',\n            ab='128k',\n            ar='44100',\n            ac='1',  # Mono\n            af='loudnorm'  # Normaliza\u00e7\u00e3o\n        ).run()\n\n    return output_path\n</code></pre>"},{"location":"architecture/integrations/#tratamento-de-erros_1","title":"Tratamento de Erros","text":"<pre><code>from openai import APIError, RateLimitError, APIConnectionError\n\ntry:\n    transcript = client.audio.transcriptions.create(...)\nexcept RateLimitError:\n    # Rate limit\n    logger.warning(\"Rate limit hit, retrying...\")\n    time.sleep(60)\nexcept APIConnectionError:\n    # Erro de conex\u00e3o\n    logger.error(\"Connection error\")\nexcept APIError as e:\n    # Erro gen\u00e9rico da API\n    logger.error(f\"API error: {e}\")\n</code></pre>"},{"location":"architecture/integrations/#aws-s3","title":"\u2601\ufe0f AWS S3","text":""},{"location":"architecture/integrations/#proposito_2","title":"Prop\u00f3sito","text":"<p>Armazenamento escal\u00e1vel de v\u00eddeos e arquivos processados.</p>"},{"location":"architecture/integrations/#configuracao_2","title":"Configura\u00e7\u00e3o","text":"<pre><code># .env\nAWS_ACCESS_KEY_ID=your_access_key\nAWS_SECRET_ACCESS_KEY=your_secret_key\nAWS_REGION=us-east-1\nS3_BUCKET_NAME=klike-videos\n</code></pre>"},{"location":"architecture/integrations/#cliente_2","title":"Cliente","text":"<pre><code>import boto3\n\ns3_client = boto3.client(\n    's3',\n    aws_access_key_id=os.getenv('AWS_ACCESS_KEY_ID'),\n    aws_secret_access_key=os.getenv('AWS_SECRET_ACCESS_KEY'),\n    region_name=os.getenv('AWS_REGION')\n)\n</code></pre>"},{"location":"architecture/integrations/#uso-no-sistema_2","title":"Uso no Sistema","text":""},{"location":"architecture/integrations/#upload-de-video","title":"Upload de V\u00eddeo","text":"<pre><code>def upload_video(file_path: str, s3_key: str) -&gt; str:\n    \"\"\"Upload com metadata e ACL\"\"\"\n    s3_client.upload_file(\n        Filename=file_path,\n        Bucket=os.getenv('S3_BUCKET_NAME'),\n        Key=s3_key,\n        ExtraArgs={\n            'ContentType': 'video/mp4',\n            'Metadata': {\n                'uploaded_at': datetime.now().isoformat(),\n                'source': 'klike-api'\n            },\n            'ACL': 'private'\n        }\n    )\n\n    return f\"s3://{os.getenv('S3_BUCKET_NAME')}/{s3_key}\"\n</code></pre>"},{"location":"architecture/integrations/#presigned-url-para-upload","title":"Presigned URL para Upload","text":"<pre><code>def generate_upload_url(s3_key: str, expires_in: int = 3600) -&gt; str:\n    \"\"\"Gera URL tempor\u00e1ria para upload direto\"\"\"\n    url = s3_client.generate_presigned_url(\n        ClientMethod='put_object',\n        Params={\n            'Bucket': os.getenv('S3_BUCKET_NAME'),\n            'Key': s3_key,\n            'ContentType': 'video/mp4'\n        },\n        ExpiresIn=expires_in\n    )\n    return url\n</code></pre>"},{"location":"architecture/integrations/#download-de-video","title":"Download de V\u00eddeo","text":"<pre><code>def download_video(s3_key: str, local_path: str) -&gt; str:\n    \"\"\"Download com progress tracking\"\"\"\n    s3_client.download_file(\n        Bucket=os.getenv('S3_BUCKET_NAME'),\n        Key=s3_key,\n        Filename=local_path,\n        Callback=ProgressPercentage(local_path)\n    )\n    return local_path\n</code></pre>"},{"location":"architecture/integrations/#estrutura-de-buckets","title":"Estrutura de Buckets","text":"<pre><code>klike-videos/\n\u251c\u2500\u2500 raw/                    # V\u00eddeos originais\n\u2502   \u2514\u2500\u2500 {user_id}/\n\u2502       \u2514\u2500\u2500 {video_id}.mp4\n\u251c\u2500\u2500 processed/              # Arquivos processados\n\u2502   \u2514\u2500\u2500 {video_id}/\n\u2502       \u251c\u2500\u2500 audio.mp3\n\u2502       \u251c\u2500\u2500 thumbnail.jpg\n\u2502       \u2514\u2500\u2500 metadata.json\n\u2514\u2500\u2500 cache/                  # Cache tempor\u00e1rio\n    \u2514\u2500\u2500 {task_id}/\n        \u2514\u2500\u2500 temp_files\n</code></pre>"},{"location":"architecture/integrations/#politicas-de-lifecycle","title":"Pol\u00edticas de Lifecycle","text":"<pre><code>{\n  \"Rules\": [\n    {\n      \"Id\": \"DeleteTempFiles\",\n      \"Status\": \"Enabled\",\n      \"Prefix\": \"cache/\",\n      \"Expiration\": {\n        \"Days\": 7\n      }\n    },\n    {\n      \"Id\": \"TransitionToIA\",\n      \"Status\": \"Enabled\",\n      \"Prefix\": \"raw/\",\n      \"Transitions\": [\n        {\n          \"Days\": 90,\n          \"StorageClass\": \"STANDARD_IA\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"architecture/integrations/#otimizacoes_1","title":"Otimiza\u00e7\u00f5es","text":"<ul> <li>\u2705 Upload multipart para arquivos &gt; 100MB</li> <li>\u2705 Transfer acceleration para uploads internacionais</li> <li>\u2705 CloudFront CDN para distribui\u00e7\u00e3o</li> <li>\u2705 S3 Intelligent-Tiering para otimizar custos</li> </ul>"},{"location":"architecture/integrations/#supabase-postgresql","title":"\ud83d\uddc4\ufe0f Supabase (PostgreSQL)","text":""},{"location":"architecture/integrations/#proposito_3","title":"Prop\u00f3sito","text":"<p>Banco de dados relacional com autentica\u00e7\u00e3o e APIs REST autom\u00e1ticas.</p>"},{"location":"architecture/integrations/#configuracao_3","title":"Configura\u00e7\u00e3o","text":"<pre><code># .env\nSUPABASE_URL=https://your-project.supabase.co\nSUPABASE_KEY=your_anon_key_here\n</code></pre>"},{"location":"architecture/integrations/#cliente_3","title":"Cliente","text":"<pre><code>from supabase import create_client\n\nsupabase = create_client(\n    supabase_url=os.getenv(\"SUPABASE_URL\"),\n    supabase_key=os.getenv(\"SUPABASE_KEY\")\n)\n</code></pre>"},{"location":"architecture/integrations/#uso-no-sistema_3","title":"Uso no Sistema","text":""},{"location":"architecture/integrations/#criar-video","title":"Criar V\u00eddeo","text":"<pre><code>def create_video_record(video_data: dict) -&gt; dict:\n    result = supabase.table('videos').insert({\n        'id': video_data['id'],\n        'user_id': video_data['user_id'],\n        'title': video_data['title'],\n        's3_url': video_data['s3_url'],\n        'status': 'uploaded',\n        'metadata': video_data.get('metadata', {})\n    }).execute()\n\n    return result.data[0]\n</code></pre>"},{"location":"architecture/integrations/#salvar-analise","title":"Salvar An\u00e1lise","text":"<pre><code>def save_analysis(video_id: str, analysis: dict) -&gt; dict:\n    result = supabase.table('analysis_results').insert({\n        'video_id': video_id,\n        'creative_score': analysis['creative_score'],\n        'detected_issues': analysis['detected_issues'],\n        'recommendations': analysis['recommendations'],\n        'transcript': analysis['transcript']\n    }).execute()\n\n    return result.data[0]\n</code></pre>"},{"location":"architecture/integrations/#consultar-com-filtros","title":"Consultar com Filtros","text":"<pre><code>def get_user_videos(user_id: str, status: str = None) -&gt; list:\n    query = supabase.table('videos') \\\n        .select('*') \\\n        .eq('user_id', user_id) \\\n        .order('created_at', desc=True)\n\n    if status:\n        query = query.eq('status', status)\n\n    result = query.execute()\n    return result.data\n</code></pre>"},{"location":"architecture/integrations/#schema-das-tabelas","title":"Schema das Tabelas","text":"<pre><code>-- Videos\nCREATE TABLE videos (\n    id UUID PRIMARY KEY,\n    user_id UUID REFERENCES auth.users(id),\n    title TEXT NOT NULL,\n    s3_url TEXT NOT NULL,\n    status TEXT CHECK (status IN ('pending', 'uploaded', 'processing', 'completed', 'failed')),\n    metadata JSONB,\n    created_at TIMESTAMP DEFAULT NOW(),\n    updated_at TIMESTAMP DEFAULT NOW()\n);\n\n-- Analysis Results\nCREATE TABLE analysis_results (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    video_id UUID REFERENCES videos(id) ON DELETE CASCADE,\n    creative_score JSONB NOT NULL,\n    detected_issues JSONB,\n    recommendations JSONB,\n    transcript TEXT,\n    created_at TIMESTAMP DEFAULT NOW()\n);\n\n-- Indexes\nCREATE INDEX idx_videos_user_id ON videos(user_id);\nCREATE INDEX idx_videos_status ON videos(status);\nCREATE INDEX idx_analysis_video_id ON analysis_results(video_id);\n</code></pre>"},{"location":"architecture/integrations/#real-time-subscriptions","title":"Real-time Subscriptions","text":"<pre><code>def subscribe_to_task_updates(task_id: str, callback):\n    \"\"\"Recebe atualiza\u00e7\u00f5es em tempo real\"\"\"\n    supabase.table('tasks') \\\n        .on('UPDATE', callback) \\\n        .eq('id', task_id) \\\n        .subscribe()\n</code></pre>"},{"location":"architecture/integrations/#row-level-security-rls","title":"Row Level Security (RLS)","text":"<pre><code>-- Usu\u00e1rios s\u00f3 veem seus pr\u00f3prios v\u00eddeos\nALTER TABLE videos ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY \"Users can view own videos\"\n    ON videos FOR SELECT\n    USING (auth.uid() = user_id);\n\nCREATE POLICY \"Users can insert own videos\"\n    ON videos FOR INSERT\n    WITH CHECK (auth.uid() = user_id);\n</code></pre>"},{"location":"architecture/integrations/#integracao-entre-servicos","title":"\ud83d\udd04 Integra\u00e7\u00e3o entre Servi\u00e7os","text":""},{"location":"architecture/integrations/#fluxo-completo","title":"Fluxo Completo","text":"<pre><code>async def complete_video_analysis_flow(video_file, user_id):\n    # 1. Upload para S3\n    s3_key = f\"raw/{user_id}/{uuid4()}.mp4\"\n    s3_url = upload_to_s3(video_file, s3_key)\n\n    # 2. Registrar no Supabase\n    video = supabase.table('videos').insert({\n        'user_id': user_id,\n        's3_url': s3_url,\n        'status': 'uploaded'\n    }).execute()\n\n    # 3. Extrair e transcrever\n    audio_path = extract_audio(video_file)\n    transcript = transcribe_with_whisper(audio_path)\n\n    # 4. Analisar com Gemini\n    analysis = analyze_with_gemini(\n        transcript['text'],\n        video['metadata']\n    )\n\n    # 5. Salvar resultados\n    supabase.table('analysis_results').insert({\n        'video_id': video['id'],\n        'transcript': transcript['text'],\n        'creative_score': analysis['scores'],\n        'detected_issues': analysis['issues'],\n        'recommendations': analysis['recommendations']\n    }).execute()\n\n    return analysis\n</code></pre>"},{"location":"architecture/integrations/#proximos-passos","title":"\ud83d\udcda Pr\u00f3ximos Passos","text":"<ul> <li>Fluxo de Dados</li> <li>Configura\u00e7\u00e3o</li> <li>Guia de Upload de V\u00eddeo</li> </ul>"},{"location":"architecture/overview/","title":"Vis\u00e3o Geral","text":""},{"location":"architecture/overview/#arquitetura-do-sistema","title":"Arquitetura do Sistema","text":"<p>Vis\u00e3o geral da arquitetura do Klike AI Services, um sistema distribu\u00eddo para an\u00e1lise inteligente de v\u00eddeos publicit\u00e1rios.</p>"},{"location":"architecture/overview/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O Klike AI Services \u00e9 constru\u00eddo com uma arquitetura moderna baseada em:</p> <ul> <li>API REST com FastAPI</li> <li>Processamento ass\u00edncrono com workers</li> <li>Armazenamento distribu\u00eddo (S3, Supabase)</li> <li>IA Generativa (Google Gemini, OpenAI)</li> <li>Microservi\u00e7os modulares e escal\u00e1veis</li> </ul> <pre><code>graph TB\n    Client[Cliente Web/Mobile]\n    API[FastAPI Application]\n    Queue[Task Queue]\n    Worker[Background Workers]\n    S3[AWS S3]\n    DB[(Supabase PostgreSQL)]\n    Gemini[Google Gemini API]\n    OpenAI[OpenAI API]\n\n    Client --&gt;|HTTP/REST| API\n    API --&gt;|Enqueue| Queue\n    API --&gt;|Read/Write| DB\n    Queue --&gt;|Process| Worker\n    Worker --&gt;|Store Videos| S3\n    Worker --&gt;|Analyze| Gemini\n    Worker --&gt;|Analyze| OpenAI\n    Worker --&gt;|Update Status| DB\n    Client --&gt;|Upload Direct| S3\n\n    style API fill:#4A90E2\n    style Worker fill:#7B68EE\n    style Gemini fill:#4285F4\n    style OpenAI fill:#00A67E</code></pre>"},{"location":"architecture/overview/#componentes-principais","title":"Componentes Principais","text":""},{"location":"architecture/overview/#1-api-gateway-fastapi","title":"1. API Gateway (FastAPI)","text":"<p>Responsabilidades:</p> <ul> <li>Receber requisi\u00e7\u00f5es HTTP dos clientes</li> <li>Validar dados de entrada</li> <li>Autenticar e autorizar requisi\u00e7\u00f5es</li> <li>Enfileirar tasks para processamento</li> <li>Retornar status e resultados</li> </ul> <p>Tecnologias:</p> <ul> <li>FastAPI 0.104+</li> <li>Pydantic para valida\u00e7\u00e3o</li> <li>Uvicorn como servidor ASGI</li> </ul>"},{"location":"architecture/overview/#2-background-workers","title":"2. Background Workers","text":"<p>Responsabilidades:</p> <ul> <li>Processar v\u00eddeos de forma ass\u00edncrona</li> <li>Extrair \u00e1udio e metadados</li> <li>Transcrever conte\u00fado</li> <li>Executar an\u00e1lise com IA</li> <li>Atualizar status das tasks</li> </ul> <p>Fluxo de Processamento:</p> <pre><code>stateDiagram-v2\n    [*] --&gt; Queued: Task criada\n    Queued --&gt; Processing: Worker dispon\u00edvel\n    Processing --&gt; ExtractingAudio: In\u00edcio\n    ExtractingAudio --&gt; Transcribing: \u00c1udio extra\u00eddo\n    Transcribing --&gt; AnalyzingAI: Transcri\u00e7\u00e3o completa\n    AnalyzingAI --&gt; GeneratingRecommendations: An\u00e1lise completa\n    GeneratingRecommendations --&gt; Completed: Tudo pronto\n\n    Processing --&gt; Failed: Erro\n    ExtractingAudio --&gt; Failed: Erro\n    Transcribing --&gt; Failed: Erro\n    AnalyzingAI --&gt; Failed: Erro\n\n    Failed --&gt; [*]\n    Completed --&gt; [*]</code></pre>"},{"location":"architecture/overview/#3-armazenamento","title":"3. Armazenamento","text":""},{"location":"architecture/overview/#aws-s3","title":"AWS S3","text":"<ul> <li>V\u00eddeos originais: Raw uploads</li> <li>Arquivos processados: \u00c1udio extra\u00eddo, thumbnails</li> <li>Cache: Resultados tempor\u00e1rios</li> <li>CDN: Distribui\u00e7\u00e3o de conte\u00fado</li> </ul>"},{"location":"architecture/overview/#supabase-postgresql","title":"Supabase (PostgreSQL)","text":"<ul> <li>Metadados de v\u00eddeos: T\u00edtulos, descri\u00e7\u00f5es, timestamps</li> <li>Resultados de an\u00e1lise: Scores, issues, recommendations</li> <li>Tasks: Estado do processamento</li> <li>Usu\u00e1rios e autentica\u00e7\u00e3o: Perfis, permiss\u00f5es</li> </ul>"},{"location":"architecture/overview/#4-servicos-de-ia","title":"4. Servi\u00e7os de IA","text":""},{"location":"architecture/overview/#google-gemini","title":"Google Gemini","text":"<ul> <li>An\u00e1lise de criatividade: Avalia\u00e7\u00e3o do conte\u00fado criativo</li> <li>Detec\u00e7\u00e3o de issues: Identifica\u00e7\u00e3o de problemas</li> <li>Gera\u00e7\u00e3o de recomenda\u00e7\u00f5es: Sugest\u00f5es de melhoria</li> <li>An\u00e1lise de compliance: Verifica\u00e7\u00e3o de pol\u00edticas</li> </ul>"},{"location":"architecture/overview/#openai","title":"OpenAI","text":"<ul> <li>Gera\u00e7\u00e3o de texto: Recomenda\u00e7\u00f5es detalhadas</li> <li>Resumos: S\u00ednteses de an\u00e1lises</li> <li>Personaliza\u00e7\u00e3o: Adapta\u00e7\u00e3o por plataforma e audi\u00eancia</li> </ul>"},{"location":"architecture/overview/#fluxo-de-dados","title":"Fluxo de Dados","text":""},{"location":"architecture/overview/#upload-e-analise-completa","title":"Upload e An\u00e1lise Completa","text":"<pre><code>sequenceDiagram\n    participant C as Cliente\n    participant API as FastAPI\n    participant S3 as AWS S3\n    participant Q as Task Queue\n    participant W as Worker\n    participant DB as Supabase\n    participant AI as Gemini/OpenAI\n\n    C-&gt;&gt;API: POST /analyze-video\n    API-&gt;&gt;DB: Cria registro\n    API-&gt;&gt;S3: Solicita presigned URL\n    S3--&gt;&gt;API: URL tempor\u00e1ria\n    API--&gt;&gt;C: {upload_url, task_id}\n\n    C-&gt;&gt;S3: Upload direto do v\u00eddeo\n    C-&gt;&gt;API: POST /confirm-upload\n\n    API-&gt;&gt;Q: Enfileira task\n    API--&gt;&gt;C: 202 Accepted\n\n    Q-&gt;&gt;W: Atribui task\n    W-&gt;&gt;S3: Download v\u00eddeo\n    W-&gt;&gt;W: Extrai \u00e1udio\n    W-&gt;&gt;S3: Upload \u00e1udio\n    W-&gt;&gt;AI: Transcreve (Whisper)\n    AI--&gt;&gt;W: Transcri\u00e7\u00e3o\n    W-&gt;&gt;AI: Analisa (Gemini)\n    AI--&gt;&gt;W: An\u00e1lise completa\n    W-&gt;&gt;DB: Salva resultados\n    W-&gt;&gt;DB: Atualiza status\n\n    C-&gt;&gt;API: GET /tasks/{task_id}\n    API-&gt;&gt;DB: Consulta status\n    DB--&gt;&gt;API: Resultado\n    API--&gt;&gt;C: 200 OK {result}</code></pre>"},{"location":"architecture/overview/#camadas-da-aplicacao","title":"Camadas da Aplica\u00e7\u00e3o","text":""},{"location":"architecture/overview/#estrutura-em-camadas","title":"Estrutura em Camadas","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     Presentation Layer (API)        \u2502\n\u2502  - Routers                          \u2502\n\u2502  - Request/Response Models          \u2502\n\u2502  - Validators                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502      Business Logic Layer           \u2502\n\u2502  - Services                         \u2502\n\u2502  - Managers                         \u2502\n\u2502  - Prompt Builders                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502       Data Access Layer             \u2502\n\u2502  - S3 Client                        \u2502\n\u2502  - Supabase Client                  \u2502\n\u2502  - External APIs                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    Infrastructure Layer             \u2502\n\u2502  - Utils                            \u2502\n\u2502  - Audio Processing                 \u2502\n\u2502  - Video Metadata                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/overview/#detalhamento-das-camadas","title":"Detalhamento das Camadas","text":""},{"location":"architecture/overview/#presentation-layer","title":"Presentation Layer","text":"<p>Routers:</p> <ul> <li><code>video_router.py</code>: Endpoints de v\u00eddeos</li> <li><code>calculator_router.py</code>: Calculadora de custos</li> </ul> <p>Schemas:</p> <ul> <li><code>base_schema_video.py</code>: Modelos de dados de v\u00eddeo</li> <li><code>calculator_schema.py</code>: Modelos de calculadora</li> </ul> <p>Validators:</p> <ul> <li><code>video_validator.py</code>: Valida\u00e7\u00e3o de v\u00eddeos</li> </ul>"},{"location":"architecture/overview/#business-logic-layer","title":"Business Logic Layer","text":"<p>Services:</p> <ul> <li><code>video_analysis_service.py</code>: Orquestra an\u00e1lise</li> <li><code>scoring_service.py</code>: Calcula scores</li> <li><code>recommendation_service.py</code>: Gera recomenda\u00e7\u00f5es</li> <li><code>prompt_builder_service.py</code>: Constr\u00f3i prompts para IA</li> <li><code>background_processor_service.py</code>: Processamento ass\u00edncrono</li> </ul> <p>Managers:</p> <ul> <li><code>task_manager.py</code>: Gerencia tasks e workers</li> </ul>"},{"location":"architecture/overview/#data-access-layer","title":"Data Access Layer","text":"<p>S3:</p> <ul> <li>Upload/download de v\u00eddeos</li> <li>Gerenciamento de buckets</li> </ul> <p>Supabase:</p> <ul> <li>Presigned URLs</li> <li>CRUD de metadados e resultados</li> <li>Gerenciamento de usu\u00e1rios</li> </ul>"},{"location":"architecture/overview/#infrastructure-layer","title":"Infrastructure Layer","text":"<p>Utils:</p> <ul> <li><code>audio_extractor.py</code>: FFmpeg wrapper</li> <li><code>transcribe_audio.py</code>: Integra\u00e7\u00e3o Whisper</li> <li><code>video_metadata_extractor.py</code>: Extra\u00e7\u00e3o de metadata</li> <li><code>subtitle_processor.py</code>: Processamento de legendas</li> </ul>"},{"location":"architecture/overview/#seguranca","title":"Seguran\u00e7a","text":""},{"location":"architecture/overview/#autenticacao-e-autorizacao","title":"Autentica\u00e7\u00e3o e Autoriza\u00e7\u00e3o","text":"<pre><code>graph LR\n    Client[Cliente]\n    API[API]\n    Auth[Auth Service]\n    DB[(Database)]\n\n    Client --&gt;|1. Credentials| API\n    API --&gt;|2. Validate| Auth\n    Auth --&gt;|3. Query| DB\n    DB --&gt;|4. User Data| Auth\n    Auth --&gt;|5. JWT Token| API\n    API --&gt;|6. Token| Client\n\n    Client --&gt;|7. Request + Token| API\n    API --&gt;|8. Verify Token| Auth\n    Auth --&gt;|9. Valid/Invalid| API\n    API --&gt;|10. Response| Client</code></pre>"},{"location":"architecture/overview/#boas-praticas-implementadas","title":"Boas Pr\u00e1ticas Implementadas","text":"<ul> <li>\u2705 HTTPS obrigat\u00f3rio em produ\u00e7\u00e3o</li> <li>\u2705 JWT tokens com expira\u00e7\u00e3o</li> <li>\u2705 Rate limiting por IP/usu\u00e1rio</li> <li>\u2705 Valida\u00e7\u00e3o de entrada com Pydantic</li> <li>\u2705 Presigned URLs tempor\u00e1rias para S3</li> <li>\u2705 Secrets em vari\u00e1veis de ambiente</li> <li>\u2705 CORS configurado adequadamente</li> </ul>"},{"location":"architecture/overview/#escalabilidade","title":"Escalabilidade","text":""},{"location":"architecture/overview/#horizontal-scaling","title":"Horizontal Scaling","text":"<p>Workers:</p> <ul> <li>M\u00faltiplas inst\u00e2ncias de workers</li> <li>Processamento paralelo de tasks</li> <li>Auto-scaling baseado em fila</li> </ul> <p>API:</p> <ul> <li>Load balancer na frente</li> <li>M\u00faltiplas r\u00e9plicas</li> <li>Stateless design</li> </ul>"},{"location":"architecture/overview/#vertical-scaling","title":"Vertical Scaling","text":"<p>Recursos por Componente:</p> Componente CPU RAM Armazenamento API 2 vCPUs 4 GB 20 GB Worker 4 vCPUs 8 GB 50 GB Database 2 vCPUs 4 GB 100 GB+"},{"location":"architecture/overview/#monitoramento-e-observabilidade","title":"Monitoramento e Observabilidade","text":""},{"location":"architecture/overview/#metricas-importantes","title":"M\u00e9tricas Importantes","text":"<ul> <li>Lat\u00eancia de API: p50, p95, p99</li> <li>Taxa de sucesso: % de an\u00e1lises completadas</li> <li>Tempo de processamento: Tempo m\u00e9dio por v\u00eddeo</li> <li>Taxa de erro: Erros por endpoint</li> <li>Utiliza\u00e7\u00e3o de recursos: CPU, RAM, disco</li> </ul>"},{"location":"architecture/overview/#logs-estruturados","title":"Logs Estruturados","text":"<pre><code>{\n  \"timestamp\": \"2024-01-15T10:30:00Z\",\n  \"level\": \"INFO\",\n  \"service\": \"video-worker\",\n  \"task_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"event\": \"analysis_completed\",\n  \"duration_ms\": 45230,\n  \"video_duration_s\": 30,\n  \"score\": 8.7\n}\n</code></pre>"},{"location":"architecture/overview/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<ul> <li>Fluxo de Dados - Entenda como os dados fluem</li> <li>Servi\u00e7os - Detalhes de cada servi\u00e7o</li> <li>Integra\u00e7\u00f5es - Integra\u00e7\u00f5es externas</li> </ul>"},{"location":"architecture/services/","title":"Servi\u00e7os","text":""},{"location":"architecture/services/#servicos","title":"Servi\u00e7os","text":"<p>Documenta\u00e7\u00e3o detalhada de cada servi\u00e7o que comp\u00f5e o Klike AI Services.</p>"},{"location":"architecture/services/#visao-geral-dos-servicos","title":"\ud83c\udfaf Vis\u00e3o Geral dos Servi\u00e7os","text":"<p>O sistema \u00e9 dividido em servi\u00e7os modulares, cada um com responsabilidade espec\u00edfica:</p> <pre><code>graph TB\n    VideoUpload[Video Upload Service]\n    VideoAnalysis[Video Analysis Service]\n    Scoring[Scoring Service]\n    Recommendation[Recommendation Service]\n    PromptBuilder[Prompt Builder Service]\n    S3Service[S3 Service]\n    Background[Background Processor]\n\n    VideoUpload --&gt; S3Service\n    VideoAnalysis --&gt; Background\n    Background --&gt; VideoAnalysis\n    VideoAnalysis --&gt; Scoring\n    VideoAnalysis --&gt; Recommendation\n    VideoAnalysis --&gt; PromptBuilder\n\n    style VideoAnalysis fill:#4A90E2\n    style Scoring fill:#7B68EE\n    style Recommendation fill:#50C878</code></pre>"},{"location":"architecture/services/#servicos-principais","title":"\ud83d\udce6 Servi\u00e7os Principais","text":""},{"location":"architecture/services/#1-video-upload-service","title":"1. Video Upload Service","text":"<p>Arquivo: <code>app/services/video_upload_service.py</code></p> <p>Responsabilidade: Gerenciar uploads de v\u00eddeos para S3.</p> <p>Principais M\u00e9todos:</p> <pre><code>class VideoUploadService:\n    def generate_presigned_url(\n        self,\n        video_id: str,\n        content_type: str = \"video/mp4\",\n        expires_in: int = 3600\n    ) -&gt; dict:\n        \"\"\"\n        Gera URL tempor\u00e1ria para upload direto ao S3.\n\n        Args:\n            video_id: UUID do v\u00eddeo\n            content_type: MIME type do v\u00eddeo\n            expires_in: Tempo de validade em segundos (padr\u00e3o: 1h)\n\n        Returns:\n            {\n                \"upload_url\": \"https://s3.amazonaws.com/...\",\n                \"fields\": {...},\n                \"expires_at\": \"2024-01-15T11:30:00Z\"\n            }\n        \"\"\"\n\n    def confirm_upload(\n        self,\n        video_id: str\n    ) -&gt; dict:\n        \"\"\"\n        Confirma que o upload foi conclu\u00eddo e valida o arquivo.\n\n        Returns:\n            {\n                \"video_id\": \"...\",\n                \"s3_url\": \"...\",\n                \"size_mb\": 45.2,\n                \"duration\": 30.5,\n                \"status\": \"uploaded\"\n            }\n        \"\"\"\n\n    def upload_video_direct(\n        self,\n        video_file: bytes,\n        video_id: str,\n        metadata: dict\n    ) -&gt; str:\n        \"\"\"\n        Upload direto via API (alternativo).\n\n        Returns:\n            s3_url: URL do v\u00eddeo no S3\n        \"\"\"\n</code></pre> <p>Depend\u00eancias:</p> <ul> <li><code>boto3</code>: Cliente AWS S3</li> <li><code>video_validator</code>: Valida\u00e7\u00e3o de v\u00eddeos</li> </ul> <p>Uso:</p> <pre><code>from app.services.video_upload_service import VideoUploadService\n\nservice = VideoUploadService()\n\n# Gerar URL para upload\nresult = service.generate_presigned_url(\n    video_id=\"550e8400-e29b-41d4-a716-446655440000\",\n    content_type=\"video/mp4\"\n)\n\n# Cliente faz upload para result[\"upload_url\"]\n\n# Confirmar upload\nconfirmation = service.confirm_upload(\n    video_id=\"550e8400-e29b-41d4-a716-446655440000\"\n)\n</code></pre>"},{"location":"architecture/services/#2-video-analysis-service","title":"2. Video Analysis Service","text":"<p>Arquivo: <code>app/services/video_analysis_service.py</code></p> <p>Responsabilidade: Orquestrar an\u00e1lise completa de v\u00eddeos.</p> <p>Principais M\u00e9todos:</p> <pre><code>class VideoAnalysisService:\n    def analyze_video(\n        self,\n        video_id: str,\n        context: AnalysisContext\n    ) -&gt; AnalysisResult:\n        \"\"\"\n        Executa an\u00e1lise completa do v\u00eddeo.\n\n        Pipeline:\n        1. Download do S3\n        2. Extra\u00e7\u00e3o de \u00e1udio\n        3. Transcri\u00e7\u00e3o\n        4. An\u00e1lise com IA\n        5. C\u00e1lculo de scores\n        6. Gera\u00e7\u00e3o de recomenda\u00e7\u00f5es\n\n        Args:\n            video_id: UUID do v\u00eddeo\n            context: {\n                \"audience\": \"jovens_adultos\",\n                \"platform\": \"instagram\",\n                \"objective\": \"conversao\"\n            }\n\n        Returns:\n            AnalysisResult com scores, issues, recomenda\u00e7\u00f5es\n        \"\"\"\n\n    def extract_and_transcribe(\n        self,\n        video_path: str\n    ) -&gt; Transcript:\n        \"\"\"\n        Extrai \u00e1udio e transcreve.\n\n        Returns:\n            Transcript com texto, timestamps, confidence\n        \"\"\"\n\n    def analyze_with_ai(\n        self,\n        transcript: str,\n        metadata: dict,\n        context: dict\n    ) -&gt; AIAnalysis:\n        \"\"\"\n        Analisa conte\u00fado usando Google Gemini.\n\n        Returns:\n            AIAnalysis com insights, issues, sugest\u00f5es\n        \"\"\"\n</code></pre> <p>Fluxo Interno:</p> <pre><code>def analyze_video(self, video_id, context):\n    # 1. Download\n    video_path = self.s3_service.download(video_id)\n\n    # 2. Extra\u00e7\u00e3o + Transcri\u00e7\u00e3o\n    transcript = self.extract_and_transcribe(video_path)\n\n    # 3. An\u00e1lise IA\n    ai_analysis = self.analyze_with_ai(\n        transcript.text,\n        video_metadata,\n        context\n    )\n\n    # 4. Scores\n    scores = self.scoring_service.calculate_scores(\n        ai_analysis,\n        transcript,\n        video_metadata\n    )\n\n    # 5. Recomenda\u00e7\u00f5es\n    recommendations = self.recommendation_service.generate(\n        scores,\n        ai_analysis.issues,\n        context\n    )\n\n    return AnalysisResult(\n        scores=scores,\n        issues=ai_analysis.issues,\n        recommendations=recommendations\n    )\n</code></pre>"},{"location":"architecture/services/#3-scoring-service","title":"3. Scoring Service","text":"<p>Arquivo: <code>app/services/scoring_service.py</code></p> <p>Responsabilidade: Calcular scores de criatividade.</p> <p>Principais M\u00e9todos:</p> <pre><code>class ScoringService:\n    def calculate_scores(\n        self,\n        ai_analysis: AIAnalysis,\n        transcript: Transcript,\n        metadata: dict\n    ) -&gt; CreativeScore:\n        \"\"\"\n        Calcula scores baseado em m\u00faltiplos crit\u00e9rios.\n\n        Returns:\n            {\n                \"overall_score\": 8.5,\n                \"hook_score\": 9.0,\n                \"message_clarity\": 8.5,\n                \"visual_appeal\": 8.0,\n                \"audio_quality\": 7.5,\n                \"call_to_action\": 8.5,\n                \"pacing\": 8.0,\n                \"engagement_potential\": 8.8\n            }\n        \"\"\"\n\n    def calculate_hook_score(\n        self,\n        first_3_seconds: str,\n        ai_insights: dict\n    ) -&gt; float:\n        \"\"\"Score do gancho inicial (0-10)\"\"\"\n\n    def calculate_message_clarity(\n        self,\n        transcript: str,\n        key_message: str\n    ) -&gt; float:\n        \"\"\"Clareza da mensagem (0-10)\"\"\"\n\n    def calculate_overall(\n        self,\n        component_scores: dict\n    ) -&gt; float:\n        \"\"\"\n        Score geral ponderado.\n\n        Pesos:\n        - Hook: 25%\n        - Message: 20%\n        - Visual: 15%\n        - Audio: 10%\n        - CTA: 15%\n        - Pacing: 10%\n        - Engagement: 5%\n        \"\"\"\n</code></pre> <p>Algoritmo de C\u00e1lculo:</p> <pre><code>def calculate_overall(self, scores):\n    weights = {\n        \"hook_score\": 0.25,\n        \"message_clarity\": 0.20,\n        \"visual_appeal\": 0.15,\n        \"audio_quality\": 0.10,\n        \"call_to_action\": 0.15,\n        \"pacing\": 0.10,\n        \"engagement_potential\": 0.05\n    }\n\n    overall = sum(\n        scores[key] * weight\n        for key, weight in weights.items()\n    )\n\n    return round(overall, 1)\n</code></pre> <p>Sistema de Descontos por Issues:</p> <pre><code>def descont_score(\n    response: dict,\n    score: int,\n    subtitles_text_and_safezone: dict,\n    non_native_vertical_aspect_ratio_violation: bool,\n    aspect_ratio_frame_url: str,\n    hook_cta_violations: dict,\n    language: str = \"en\"\n) -&gt; dict:\n    \"\"\"\n    Aplica descontos no score baseado em issues t\u00e9cnicas detectadas.\n\n    Args:\n        response: Resultado da an\u00e1lise com detected_issues\n        score: Score inicial calculado\n        subtitles_text_and_safezone: Informa\u00e7\u00f5es de legendas e safe zone\n        non_native_vertical_aspect_ratio_violation: Viola\u00e7\u00e3o de aspect ratio\n        aspect_ratio_frame_url: URL do frame de exemplo\n        hook_cta_violations: Viola\u00e7\u00f5es de limite de caracteres\n        language: Idioma para mensagens\n\n    Returns:\n        {\n            \"final_score\": 7.5,\n            \"total_discount\": 2.5,\n            \"detected_issues\": {...}  # Apenas issues True\n        }\n    \"\"\"\n\n    discount_table = {\n        'small_subtitles': 4,\n        'fake_content': 10,\n        'subtitle_position': 8,\n        'guideline_compliance': 12,\n        'safezone': 10,\n        'hook_cta_char_limit': 5,\n        'non_native_vertical_aspect_ratio_violation': 3\n    }\n\n    total_discount = 0\n    detected_issues_true = {}\n\n    for issue, discount in discount_table.items():\n        if response['detected_issues'].get(issue):\n            total_discount += discount\n            detected_issues_true[issue] = True\n            detected_issues_true[f'details_{issue}'] = response['detected_issues'].get(f'details_{issue}')\n\n    final_score = max(0, score - total_discount)\n\n    return {\n        'final_score': final_score,\n        'total_discount': total_discount,\n        'detected_issues': detected_issues_true\n    }\n</code></pre> <p>Valida\u00e7\u00e3o de Hook/CTA:</p> <p>O sistema valida limites de caracteres por plataforma:</p> Plataforma Limite Hook Limite CTA TikTok 60 30 Meta 80 40 LinkedIn 100 50 YouTube Ilimitado 50 <pre><code>def check_hook_cta_char_violations(hook: str, cta: str, platforms: list) -&gt; dict:\n    \"\"\"Verifica viola\u00e7\u00f5es de limite de caracteres.\"\"\"\n    limits = {\n        'tiktok': {'hook': 60, 'cta': 30},\n        'meta': {'hook': 80, 'cta': 40},\n        'linkedin': {'hook': 100, 'cta': 50},\n        'youtube': {'hook': None, 'cta': 50}\n    }\n\n    violations = {\n        'hook_violation': {'has_violation': False},\n        'cta_violation': {'has_violation': False}\n    }\n\n    for platform in platforms:\n        limit = limits.get(platform.lower())\n        if limit and limit['hook'] and len(hook) &gt; limit['hook']:\n            violations['hook_violation'] = {\n                'has_violation': True,\n                'detected_length': len(hook),\n                'platforms': [platform],\n                'limit': limit['hook']\n            }\n        if limit and len(cta) &gt; limit['cta']:\n            violations['cta_violation'] = {\n                'has_violation': True,\n                'detected_length': len(cta),\n                'platforms': [platform],\n                'limit': limit['cta']\n            }\n\n    return violations\n</code></pre>"},{"location":"architecture/services/#4-recommendation-service","title":"4. Recommendation Service","text":"<p>Arquivo: <code>app/services/recommendation_service.py</code></p> <p>Responsabilidade: Gerar recomenda\u00e7\u00f5es personalizadas.</p> <p>Principais M\u00e9todos:</p> <pre><code>class RecommendationService:\n    def generate_recommendations(\n        self,\n        scores: CreativeScore,\n        issues: List[DetectedIssue],\n        context: AnalysisContext\n    ) -&gt; List[Recommendation]:\n        \"\"\"\n        Gera recomenda\u00e7\u00f5es baseadas em:\n        1. Scores baixos\n        2. Issues detectados\n        3. Melhores pr\u00e1ticas da plataforma\n        4. Contexto da audi\u00eancia\n\n        Returns:\n            Lista de recomenda\u00e7\u00f5es priorizadas\n        \"\"\"\n\n    def generate_from_scores(\n        self,\n        scores: dict\n    ) -&gt; List[Recommendation]:\n        \"\"\"Recomenda\u00e7\u00f5es baseadas em scores baixos\"\"\"\n\n    def generate_from_issues(\n        self,\n        issues: List[DetectedIssue]\n    ) -&gt; List[Recommendation]:\n        \"\"\"Recomenda\u00e7\u00f5es para corrigir issues\"\"\"\n\n    def apply_platform_best_practices(\n        self,\n        platform: str,\n        recommendations: List[Recommendation]\n    ) -&gt; List[Recommendation]:\n        \"\"\"Adiciona melhores pr\u00e1ticas da plataforma\"\"\"\n</code></pre> <p>Prioriza\u00e7\u00e3o:</p> <pre><code>def prioritize_recommendations(recommendations):\n    \"\"\"\n    Prioriza por:\n    1. Severity (high &gt; medium &gt; low)\n    2. Impact (alto potencial de melhoria)\n    3. Effort (baixo esfor\u00e7o primeiro)\n    \"\"\"\n\n    priority_scores = []\n    for rec in recommendations:\n        score = (\n            severity_weight[rec.severity] * 0.5 +\n            impact_score[rec.impact] * 0.3 +\n            (1 - effort_score[rec.effort]) * 0.2\n        )\n        priority_scores.append((score, rec))\n\n    return [rec for _, rec in sorted(\n        priority_scores,\n        key=lambda x: x[0],\n        reverse=True\n    )]\n</code></pre>"},{"location":"architecture/services/#5-prompt-builder-service","title":"5. Prompt Builder Service","text":"<p>Arquivo: <code>app/services/prompt_builder_service.py</code></p> <p>Responsabilidade: Construir prompts para IA generativa.</p> <p>Principais M\u00e9todos:</p> <pre><code>class PromptBuilderService:\n    def build_analysis_prompt(\n        self,\n        transcript: str,\n        metadata: dict,\n        context: dict\n    ) -&gt; str:\n        \"\"\"\n        Constr\u00f3i prompt completo para an\u00e1lise.\n\n        Estrutura:\n        1. Contexto do sistema\n        2. Informa\u00e7\u00f5es do v\u00eddeo\n        3. Contexto da an\u00e1lise\n        4. Instru\u00e7\u00f5es espec\u00edficas\n        5. Formato de resposta esperado\n        \"\"\"\n\n    def load_template(\n        self,\n        language: str,\n        template_type: str\n    ) -&gt; str:\n        \"\"\"\n        Carrega template de prompt.\n\n        Args:\n            language: \"pt\" ou \"en\"\n            template_type: \"analysis\", \"compliance\", \"detected_issue\"\n        \"\"\"\n</code></pre> <p>Exemplo de Prompt Gerado:</p> <pre><code>prompt = f\"\"\"\nVoc\u00ea \u00e9 um especialista em an\u00e1lise de v\u00eddeos publicit\u00e1rios.\n\nINFORMA\u00c7\u00d5ES DO V\u00cdDEO:\n- Dura\u00e7\u00e3o: {metadata['duration']}s\n- Plataforma: {context['platform']}\n- Audi\u00eancia: {context['audience']}\n- Objetivo: {context['objective']}\n\nTRANSCRI\u00c7\u00c3O:\n{transcript}\n\nAN\u00c1LISE REQUERIDA:\n1. Avalie o gancho inicial (primeiros 3 segundos)\n2. Analise a clareza da mensagem\n3. Identifique pontos fortes\n4. Detecte issues e problemas\n5. Sugira melhorias espec\u00edficas\n\nFORMATO DE RESPOSTA:\n{{\n  \"hook_analysis\": \"...\",\n  \"message_clarity\": \"...\",\n  \"strengths\": [...],\n  \"issues\": [...],\n  \"suggestions\": [...]\n}}\n\"\"\"\n</code></pre>"},{"location":"architecture/services/#6-s3-video-service","title":"6. S3 Video Service","text":"<p>Arquivo: <code>app/services/s3_video_service.py</code></p> <p>Responsabilidade: Gerenciar opera\u00e7\u00f5es com AWS S3.</p> <p>Principais M\u00e9todos:</p> <pre><code>class S3VideoService:\n    def upload_file(\n        self,\n        file_path: str,\n        s3_key: str,\n        metadata: dict = None\n    ) -&gt; str:\n        \"\"\"Upload de arquivo para S3\"\"\"\n\n    def download_file(\n        self,\n        s3_key: str,\n        local_path: str\n    ) -&gt; str:\n        \"\"\"Download de arquivo do S3\"\"\"\n\n    def generate_presigned_url(\n        self,\n        s3_key: str,\n        expires_in: int = 3600\n    ) -&gt; str:\n        \"\"\"Gera URL tempor\u00e1ria para acesso\"\"\"\n\n    def delete_file(\n        self,\n        s3_key: str\n    ) -&gt; bool:\n        \"\"\"Remove arquivo do S3\"\"\"\n\n    def get_file_metadata(\n        self,\n        s3_key: str\n    ) -&gt; dict:\n        \"\"\"Retorna metadata do arquivo\"\"\"\n</code></pre>"},{"location":"architecture/services/#7-background-processor-service","title":"7. Background Processor Service","text":"<p>Arquivo: <code>app/services/background_processor_service.py</code></p> <p>Responsabilidade: Processar tasks em background.</p> <p>Principais M\u00e9todos:</p> <pre><code>class BackgroundProcessorService:\n    def enqueue_task(\n        self,\n        task_type: str,\n        video_id: str,\n        params: dict\n    ) -&gt; str:\n        \"\"\"Enfileira task para processamento\"\"\"\n\n    def process_video_analysis(\n        self,\n        task_id: str,\n        video_id: str,\n        context: dict\n    ) -&gt; dict:\n        \"\"\"Processa an\u00e1lise de v\u00eddeo em background\"\"\"\n\n    def update_task_status(\n        self,\n        task_id: str,\n        status: str,\n        progress: int = None,\n        result: dict = None\n    ) -&gt; None:\n        \"\"\"Atualiza status da task\"\"\"\n</code></pre>"},{"location":"architecture/services/#managers","title":"\ud83d\udd27 Managers","text":""},{"location":"architecture/services/#task-manager","title":"Task Manager","text":"<p>Arquivo: <code>app/managers/task_manager.py</code></p> <p>Responsabilidade: Gerenciar workers e distribui\u00e7\u00e3o de tasks.</p> <pre><code>class TaskManager:\n    def start_workers(self, num_workers: int = 4):\n        \"\"\"Inicia workers para processamento\"\"\"\n\n    def assign_task(self, task_id: str) -&gt; Worker:\n        \"\"\"Atribui task a worker dispon\u00edvel\"\"\"\n\n    def monitor_health(self):\n        \"\"\"Monitora sa\u00fade dos workers\"\"\"\n</code></pre>"},{"location":"architecture/services/#proximos-passos","title":"\ud83d\udcda Pr\u00f3ximos Passos","text":"<ul> <li>Integra\u00e7\u00f5es - Integra\u00e7\u00f5es externas</li> <li>Estrutura do Projeto</li> </ul>"},{"location":"development/project-structure/","title":"Estrutura do Projeto","text":""},{"location":"development/project-structure/#estrutura-do-projeto","title":"Estrutura do Projeto","text":"<p>Documenta\u00e7\u00e3o completa da organiza\u00e7\u00e3o e arquitetura de c\u00f3digo do Klike AI Services.</p>"},{"location":"development/project-structure/#visao-geral","title":"Vis\u00e3o Geral","text":"<pre><code>klike-ai-services/\n\u251c\u2500\u2500 app/                          # C\u00f3digo principal da aplica\u00e7\u00e3o\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 app.py                    # FastAPI application entry point\n\u2502   \u251c\u2500\u2500 dependencies.py           # Inje\u00e7\u00e3o de depend\u00eancias\n\u2502   \u251c\u2500\u2500 audio/                    # M\u00f3dulo de processamento de \u00e1udio\n\u2502   \u251c\u2500\u2500 managers/                 # Gerenciamento de tasks e workers\n\u2502   \u251c\u2500\u2500 prompts/                  # Templates de prompts para IA\n\u2502   \u251c\u2500\u2500 routers/                  # Endpoints da API\n\u2502   \u251c\u2500\u2500 schemas/                  # Modelos Pydantic\n\u2502   \u251c\u2500\u2500 services/                 # L\u00f3gica de neg\u00f3cio\n\u2502   \u251c\u2500\u2500 static/                   # Arquivos est\u00e1ticos (HTML, CSS, JS)\n\u2502   \u251c\u2500\u2500 utils/                    # Utilit\u00e1rios e helpers\n\u2502   \u2514\u2500\u2500 validators/               # Validadores customizados\n\u251c\u2500\u2500 data/                         # Dados de desenvolvimento/teste\n\u2502   \u2514\u2500\u2500 mp4/                      # V\u00eddeos de exemplo\n\u251c\u2500\u2500 docs/                         # Documenta\u00e7\u00e3o MkDocs\n\u2502   \u251c\u2500\u2500 api/                      # Docs da API\n\u2502   \u251c\u2500\u2500 architecture/             # Docs de arquitetura\n\u2502   \u251c\u2500\u2500 development/              # Guias para desenvolvedores\n\u2502   |\u2500\u2500 getting-started/          # Guias de in\u00edcio\n\u2502   \n\u251c\u2500\u2500 env/                          # Virtual environment (n\u00e3o versionado)\n\u251c\u2500\u2500 notebooks/                    # Jupyter notebooks para experimenta\u00e7\u00e3o\n\u251c\u2500\u2500 scripts/                      # Scripts de automa\u00e7\u00e3o\n\u2502   \u251c\u2500\u2500 build-docs.ps1\n\u2502   \u251c\u2500\u2500 deploy-docs.ps1\n\u2502   \u2514\u2500\u2500 serve-docs.ps1\n\u251c\u2500\u2500 .github/                      # GitHub Actions workflows\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u2514\u2500\u2500 deploy-docs.yml\n\u251c\u2500\u2500 .env                          # Vari\u00e1veis de ambiente (n\u00e3o versionado)\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 Dockerfile                    # Container Docker\n\u251c\u2500\u2500 mkdocs.yml                    # Configura\u00e7\u00e3o da documenta\u00e7\u00e3o\n\u251c\u2500\u2500 PUBLISHING_GUIDE.md           # Guia de publica\u00e7\u00e3o\n\u251c\u2500\u2500 README.md                     # README principal\n\u2514\u2500\u2500 requirements.txt              # Depend\u00eancias Python\n</code></pre>"},{"location":"development/project-structure/#principais-diretorios","title":"Principais Diret\u00f3rios","text":""},{"location":"development/project-structure/#app-aplicacao-principal","title":"<code>/app</code> - Aplica\u00e7\u00e3o Principal","text":"<pre><code>app/\n\u251c\u2500\u2500 app.py                        # Entry point, configura\u00e7\u00e3o FastAPI\n\u251c\u2500\u2500 dependencies.py               # Dependency injection\n\u251c\u2500\u2500 audio/                        \n\u2502   \u2514\u2500\u2500 audio_analyzer.py         # An\u00e1lise de caracter\u00edsticas de \u00e1udio\n\u251c\u2500\u2500 managers/\n\u2502   \u2514\u2500\u2500 task_manager.py           # Gerenciamento de tasks ass\u00edncronas\n\u251c\u2500\u2500 prompts/\n\u2502   \u251c\u2500\u2500 en/                       # Prompts em ingl\u00eas\n\u2502   \u2502   \u251c\u2500\u2500 compliance.txt\n\u2502   \u2502   \u251c\u2500\u2500 detected_issue.txt\n\u2502   \u2502   \u2514\u2500\u2500 audiences/\n\u2502   \u2514\u2500\u2500 pt/                       # Prompts em portugu\u00eas\n\u2502       \u251c\u2500\u2500 compliance.txt\n\u2502       \u251c\u2500\u2500 detected_issue.txt\n\u2502       \u2514\u2500\u2500 platforms/\n\u251c\u2500\u2500 routers/\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 calculator_router.py      # Endpoints da calculadora\n\u2502   \u2514\u2500\u2500 video_router.py           # Endpoints de v\u00eddeo\n\u251c\u2500\u2500 schemas/\n\u2502   \u251c\u2500\u2500 base_schema_video.py      # Modelos de v\u00eddeo\n\u2502   \u2514\u2500\u2500 calculator_schema.py      # Modelos da calculadora\n\u251c\u2500\u2500 services/\n\u2502   \u251c\u2500\u2500 action_generation_service.py\n\u2502   \u251c\u2500\u2500 background_processor_service.py\n\u2502   \u251c\u2500\u2500 prompt_builder_service.py\n\u2502   \u251c\u2500\u2500 recommendation_service.py\n\u2502   \u251c\u2500\u2500 s3_video_service.py\n\u2502   \u251c\u2500\u2500 scoring_service.py\n\u2502   \u251c\u2500\u2500 video_analysis_service.py\n\u2502   \u2514\u2500\u2500 video_upload_service.py\n\u251c\u2500\u2500 static/\n\u2502   \u2514\u2500\u2500 index.html                # Documenta\u00e7\u00e3o interativa Swagger\n\u251c\u2500\u2500 utils/\n\u2502   \u251c\u2500\u2500 actions.py\n\u2502   \u251c\u2500\u2500 actions_extra_content_prompts.py\n\u2502   \u251c\u2500\u2500 actions_filters.py\n\u2502   \u251c\u2500\u2500 actions_formatters.py\n\u2502   \u251c\u2500\u2500 actions_prompts_config.py\n\u2502   \u251c\u2500\u2500 audio_extractor.py\n\u2502   \u251c\u2500\u2500 budget_calculator.py\n\u2502   \u251c\u2500\u2500 s3.py\n\u2502   \u251c\u2500\u2500 subtitle_processor.py\n\u2502   \u251c\u2500\u2500 transcribe_audio.py\n\u2502   \u251c\u2500\u2500 utils.py\n\u2502   \u2514\u2500\u2500 video_metadata_extractor.py\n\u2514\u2500\u2500 validators/\n    \u2514\u2500\u2500 video_validator.py\n</code></pre>"},{"location":"development/project-structure/#docs-documentacao","title":"<code>/docs</code> - Documenta\u00e7\u00e3o","text":"<p>Documenta\u00e7\u00e3o t\u00e9cnica e guias do usu\u00e1rio usando MkDocs Material.</p> <pre><code>docs/\n\u251c\u2500\u2500 index.md                      # Homepage\n\u251c\u2500\u2500 api/                          # Refer\u00eancia da API\n\u2502   \u251c\u2500\u2500 overview.md\n\u2502   \u251c\u2500\u2500 video-analysis.md\n\u2502   \u251c\u2500\u2500 s3-integration.md\n\u2502   \u251c\u2500\u2500 background-tasks.md\n\u2502   \u2514\u2500\u2500 calculator.md\n\u251c\u2500\u2500 architecture/                 # Arquitetura do sistema\n\u2502   \u251c\u2500\u2500 overview.md\n\u2502   \u251c\u2500\u2500 data-flow.md\n\u2502   \u251c\u2500\u2500 services.md\n\u2502   \u2514\u2500\u2500 integrations.md\n\u251c\u2500\u2500 development/                  # Para desenvolvedores\n\u2502   \u2514\u2500\u2500 project-structure.md\n\u2502   \n\u2514\u2500\u2500 getting-started/              # In\u00edcio r\u00e1pido\n    \u251c\u2500\u2500 installation.md\n    \u251c\u2500\u2500 configuration.md\n    \u2514\u2500\u2500 quickstart.md\n</code></pre>"},{"location":"development/project-structure/#notebooks-experimentacao","title":"<code>/notebooks</code> - Experimenta\u00e7\u00e3o","text":"<p>Jupyter notebooks para prototipagem e an\u00e1lise explorat\u00f3ria.</p> <pre><code>notebooks/\n\u251c\u2500\u2500 functions_recommendation.ipynb\n\u251c\u2500\u2500 gemini_api_files.ipynb\n\u251c\u2500\u2500 generate_actions_for_issues.ipynb\n\u251c\u2500\u2500 generate_audience_actions.ipynb\n\u251c\u2500\u2500 generate_plataforms.ipynb\n\u251c\u2500\u2500 s3.ipynb\n\u2514\u2500\u2500 teste_params_video.ipynb\n</code></pre>"},{"location":"development/project-structure/#scripts-automacao","title":"<code>/scripts</code> - Automa\u00e7\u00e3o","text":"<p>Scripts PowerShell para tarefas comuns de desenvolvimento.</p> <pre><code>scripts/\n\u251c\u2500\u2500 README.md                     # Documenta\u00e7\u00e3o dos scripts\n\u251c\u2500\u2500 build-docs.ps1                # Build documenta\u00e7\u00e3o\n\u251c\u2500\u2500 deploy-docs.ps1               # Deploy documenta\u00e7\u00e3o\n\u2514\u2500\u2500 serve-docs.ps1                # Serve documenta\u00e7\u00e3o localmente\n</code></pre>"},{"location":"development/project-structure/#arquitetura-em-camadas","title":"Arquitetura em Camadas","text":""},{"location":"development/project-structure/#1-presentation-layer-routers","title":"1. Presentation Layer (Routers)","text":"<p>Responsabilidade: Receber requisi\u00e7\u00f5es HTTP, validar entrada, retornar respostas.</p> <p>Arquivos:</p> <ul> <li><code>routers/video_router.py</code></li> <li><code>routers/calculator_router.py</code></li> </ul> <p>Exemplo:</p> <pre><code># routers/video_router.py\nfrom fastapi import APIRouter, Depends, UploadFile\nfrom app.schemas.base_schema_video import VideoAnalysisRequest\nfrom app.services.video_analysis_service import VideoAnalysisService\n\nrouter = APIRouter(prefix=\"/api/v1/videos\", tags=[\"videos\"])\n\n@router.post(\"/analyze\")\nasync def analyze_video(\n    request: VideoAnalysisRequest,\n    service: VideoAnalysisService = Depends()\n):\n    \"\"\"Endpoint para an\u00e1lise de v\u00eddeo\"\"\"\n    result = await service.analyze(request)\n    return result\n</code></pre>"},{"location":"development/project-structure/#2-business-logic-layer-services","title":"2. Business Logic Layer (Services)","text":"<p>Responsabilidade: Implementar regras de neg\u00f3cio, orquestrar opera\u00e7\u00f5es.</p> <p>Arquivos:</p> <ul> <li><code>services/video_analysis_service.py</code></li> <li><code>services/scoring_service.py</code></li> <li><code>services/recommendation_service.py</code></li> <li><code>services/prompt_builder_service.py</code></li> </ul> <p>Padr\u00e3o:</p> <pre><code># services/video_analysis_service.py\nclass VideoAnalysisService:\n    def __init__(\n        self,\n        s3_service: S3VideoService,\n        scoring_service: ScoringService,\n        recommendation_service: RecommendationService\n    ):\n        self.s3 = s3_service\n        self.scoring = scoring_service\n        self.recommendations = recommendation_service\n\n    async def analyze(self, video_id: str) -&gt; AnalysisResult:\n        # Orquestrar todo o fluxo de an\u00e1lise\n        video = await self.s3.download(video_id)\n        transcript = await self.transcribe(video)\n        scores = await self.scoring.calculate(transcript)\n        recs = await self.recommendations.generate(scores)\n\n        return AnalysisResult(\n            scores=scores,\n            recommendations=recs\n        )\n</code></pre>"},{"location":"development/project-structure/#3-data-access-layer-utils","title":"3. Data Access Layer (Utils)","text":"<p>Responsabilidade: Interagir com servi\u00e7os externos, I/O, processamento de dados.</p> <p>Arquivos:</p> <ul> <li><code>utils/s3.py</code> - Cliente AWS S3</li> <li><code>utils/transcribe_audio.py</code> - Integra\u00e7\u00e3o Whisper</li> <li><code>utils/audio_extractor.py</code> - FFmpeg wrapper</li> <li><code>utils/video_metadata_extractor.py</code> - Extra\u00e7\u00e3o de metadados</li> </ul>"},{"location":"development/project-structure/#4-domain-layer-schemas","title":"4. Domain Layer (Schemas)","text":"<p>Responsabilidade: Definir modelos de dados, valida\u00e7\u00e3o.</p> <p>Arquivos:</p> <ul> <li><code>schemas/base_schema_video.py</code></li> <li><code>schemas/calculator_schema.py</code></li> </ul> <p>Exemplo:</p> <pre><code># schemas/base_schema_video.py\nfrom pydantic import BaseModel, Field\nfrom typing import Optional, List\n\nclass VideoAnalysisRequest(BaseModel):\n    video_id: str = Field(..., description=\"UUID do v\u00eddeo\")\n    platform: str = Field(..., description=\"Plataforma alvo\")\n    audience: str = Field(..., description=\"Audi\u00eancia alvo\")\n\n    class Config:\n        json_schema_extra = {\n            \"example\": {\n                \"video_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n                \"platform\": \"instagram\",\n                \"audience\": \"jovens_adultos\"\n            }\n        }\n</code></pre>"},{"location":"development/project-structure/#padroes-de-codigo","title":"Padr\u00f5es de C\u00f3digo","text":""},{"location":"development/project-structure/#dependency-injection","title":"Dependency Injection","text":"<pre><code># dependencies.py\nfrom functools import lru_cache\nfrom app.services.video_analysis_service import VideoAnalysisService\n\n@lru_cache()\ndef get_video_analysis_service() -&gt; VideoAnalysisService:\n    return VideoAnalysisService()\n\n# Uso nos routers\n@router.post(\"/analyze\")\nasync def analyze(\n    request: VideoAnalysisRequest,\n    service: VideoAnalysisService = Depends(get_video_analysis_service)\n):\n    return await service.analyze(request)\n</code></pre>"},{"location":"development/project-structure/#error-handling","title":"Error Handling","text":"<pre><code># routers/video_router.py\nfrom fastapi import HTTPException\n\n@router.post(\"/upload\")\nasync def upload_video(file: UploadFile):\n    try:\n        result = await service.upload(file)\n        return result\n    except VideoTooLargeError as e:\n        raise HTTPException(\n            status_code=413,\n            detail={\n                \"error\": \"FILE_TOO_LARGE\",\n                \"message\": str(e),\n                \"max_size_mb\": 500\n            }\n        )\n    except Exception as e:\n        logger.exception(\"Unexpected error during upload\")\n        raise HTTPException(\n            status_code=500,\n            detail={\"error\": \"INTERNAL_ERROR\", \"message\": \"Upload failed\"}\n        )\n</code></pre>"},{"location":"development/project-structure/#logging","title":"Logging","text":"<pre><code>import logging\n\nlogger = logging.getLogger(__name__)\n\nclass VideoAnalysisService:\n    async def analyze(self, video_id: str):\n        logger.info(f\"Starting analysis for video {video_id}\")\n\n        try:\n            result = await self._process(video_id)\n            logger.info(f\"Analysis completed for {video_id}\")\n            return result\n        except Exception as e:\n            logger.error(f\"Analysis failed for {video_id}: {e}\")\n            raise\n</code></pre>"},{"location":"development/project-structure/#configuration","title":"Configuration","text":"<pre><code># dependencies.py\nfrom pydantic_settings import BaseSettings\n\nclass Settings(BaseSettings):\n    google_gemini_api_key: str\n    openai_api_key: str\n    aws_access_key_id: str\n    aws_secret_access_key: str\n    s3_bucket_name: str\n    supabase_url: str\n    supabase_key: str\n\n    class Config:\n        env_file = \".env\"\n\n@lru_cache()\ndef get_settings() -&gt; Settings:\n    return Settings()\n</code></pre>"},{"location":"development/project-structure/#codigo-python","title":"C\u00f3digo Python","text":"<pre><code># Classes: PascalCase\nclass VideoAnalysisService:\n    pass\n\n# Fun\u00e7\u00f5es/m\u00e9todos: snake_case\ndef analyze_video():\n    pass\n\n# Constantes: UPPER_SNAKE_CASE\nMAX_VIDEO_SIZE_MB = 500\n\n# Vari\u00e1veis: snake_case\nvideo_id = \"abc123\"\n\n# Privados: prefixo _\ndef _internal_method():\n    pass\n</code></pre>"},{"location":"development/project-structure/#recursos-adicionais","title":"Recursos Adicionais","text":"<ul> <li>Arquitetura - Vis\u00e3o geral da arquitetura</li> </ul>"},{"location":"getting-started/configuration/","title":"Configura\u00e7\u00e3o","text":""},{"location":"getting-started/configuration/#configuracao","title":"Configura\u00e7\u00e3o","text":"<p>Este guia explica como configurar todas as vari\u00e1veis de ambiente e integra\u00e7\u00f5es necess\u00e1rias para o Klike AI Services.</p>"},{"location":"getting-started/configuration/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O Klike AI Services requer configura\u00e7\u00e3o de 4 servi\u00e7os externos:</p> Servi\u00e7o Prop\u00f3sito Obrigat\u00f3rio Google Gemini An\u00e1lise de v\u00eddeo com IA \u2705 Sim OpenAI Gera\u00e7\u00e3o de recomenda\u00e7\u00f5es \u2705 Sim AWS S3 (storage) + Rekognition (OCR) \u2705 Sim Supabase Storage de frames extra\u00eddos \u2705 Sim"},{"location":"getting-started/configuration/#variaveis-de-ambiente","title":"Vari\u00e1veis de Ambiente","text":""},{"location":"getting-started/configuration/#1-crie-o-arquivo-env","title":"1. Crie o arquivo <code>.env</code>","text":"<p>Na raiz do projeto, crie um arquivo <code>.env</code>:</p> <pre><code>touch .env  # Linux/macOS\n# ou\nNew-Item .env  # Windows PowerShell\n</code></pre>"},{"location":"getting-started/configuration/#2-template-completo","title":"2. Template Completo","text":"<p>Copie e preencha com suas credenciais:</p> <pre><code># ======================\n# GOOGLE GEMINI API\n# ======================\nGOOGLE_API_KEY=AIzaSy...xxxxxxxxx\n\n# ======================\n# OPENAI API\n# ======================\nOPENAI_API_KEY=sk-proj-...xxxxxxxxx\n\n# ======================\n# AWS CREDENTIALS\n# ======================\nAWS_ACCESS_KEY_ID=AKIA...xxxxxxxxx\nAWS_SECRET_ACCESS_KEY=wJalr...xxxxxxxxx\nAWS_REGION=us-east-1\nS3_BUCKET_NAME=klike-videos\n\n# ======================\n# SUPABASE\n# ======================\nSUPABASE_URL=https://xxxxx.supabase.co\nSUPABASE_KEY=eyJhb...xxxxxxxxx\nSUPABASE_BUCKET=video-frames\n</code></pre> <p>Seguran\u00e7a</p> <p>NUNCA commite o arquivo <code>.env</code> no Git! Ele j\u00e1 est\u00e1 no <code>.gitignore</code>.</p>"},{"location":"getting-started/configuration/#obter-credenciais","title":"Obter Credenciais","text":""},{"location":"getting-started/configuration/#google-gemini-api","title":"Google Gemini API","text":"<ol> <li>Acesse Google AI Studio</li> <li>Clique em \"Get API Key\"</li> <li>Crie um novo projeto ou selecione existente</li> <li>Copie a chave gerada</li> </ol> <pre><code>GOOGLE_API_KEY=AIzaSyBxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n</code></pre> <p>Modelo Usado</p> <p>O projeto usa o Gemini 2.5 Pro para an\u00e1lise de v\u00eddeo multimodal.</p>"},{"location":"getting-started/configuration/#openai-api","title":"OpenAI API","text":"<ol> <li>Acesse OpenAI Platform</li> <li>Fa\u00e7a login ou crie uma conta</li> <li>Clique em \"Create new secret key\"</li> <li>D\u00ea um nome (ex: \"Klike AI Services\")</li> <li>Copie a chave (ela s\u00f3 aparece uma vez!)</li> </ol> <pre><code>OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n</code></pre> <p>Modelo Usado</p> <p>O projeto usa o GPT-4o-mini para gera\u00e7\u00e3o de recomenda\u00e7\u00f5es via LangChain.</p> <p>Custo Estimado: - An\u00e1lise de 1 v\u00eddeo \u2248 $0.02 - $0.05 USD - 100 v\u00eddeos/m\u00eas \u2248 $2 - $5 USD</p>"},{"location":"getting-started/configuration/#aws-credentials","title":"AWS Credentials","text":""},{"location":"getting-started/configuration/#1-criar-usuario-iam","title":"1. Criar Usu\u00e1rio IAM","text":"<ol> <li>Acesse AWS IAM Console</li> <li>V\u00e1 em Users \u2192 Add users</li> <li>Nome: <code>klike-ai-services</code></li> <li>Selecione Access key - Programmatic access</li> <li>Clique em Next: Permissions</li> </ol>"},{"location":"getting-started/configuration/#2-configurar-permissoes","title":"2. Configurar Permiss\u00f5es","text":"<p>Crie ou anexe uma policy com estas permiss\u00f5es:</p> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\",\n        \"s3:ListBucket\",\n        \"s3:DeleteObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::seu-bucket-name\",\n        \"arn:aws:s3:::seu-bucket-name/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rekognition:DetectText\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"getting-started/configuration/#3-criar-bucket-s3","title":"3. Criar Bucket S3","text":"<pre><code>aws s3 mb s3://klike-videos --region us-east-1\n</code></pre> <p>Ou via console:</p> <ol> <li>Acesse S3 Console</li> <li>Create bucket \u2192 Nome: <code>klike-videos</code></li> <li>Region: <code>us-east-1</code></li> <li>Block all public access:  (desmarque)</li> <li>Create bucket</li> </ol>"},{"location":"getting-started/configuration/#4-estrutura-do-bucket","title":"4. Estrutura do Bucket","text":"<p>O bucket deve seguir esta estrutura:</p> <pre><code>klike-videos/\n\u251c\u2500\u2500 mp4/          # V\u00eddeos originais\n\u251c\u2500\u2500 mp3/          # \u00c1udios extra\u00eddos (opcional)\n\u251c\u2500\u2500 outputs/      # Transcri\u00e7\u00f5es (futuro)\n\u2514\u2500\u2500 metadata/     # Metadados JSON (futuro)\n</code></pre>"},{"location":"getting-started/configuration/#5-configurar-no-env","title":"5. Configurar no <code>.env</code>","text":"<pre><code>AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\nAWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\nAWS_REGION=us-east-1\nS3_BUCKET_NAME=klike-videos\n</code></pre>"},{"location":"getting-started/configuration/#supabase","title":"Supabase","text":""},{"location":"getting-started/configuration/#1-criar-projeto","title":"1. Criar Projeto","text":"<ol> <li>Acesse Supabase Dashboard</li> <li>New project \u2192 Nome: <code>klike-ai-services</code></li> <li>Database Password: Escolha uma senha forte</li> <li>Region: Escolha a mais pr\u00f3xima</li> <li>Create new project (leva ~2 min)</li> </ol>"},{"location":"getting-started/configuration/#2-criar-bucket-de-storage","title":"2. Criar Bucket de Storage","text":"<ol> <li>V\u00e1 em Storage no menu lateral</li> <li>Create a new bucket</li> <li>Nome: <code>video-frames</code></li> <li>Public bucket:  (marque)</li> <li>Create bucket</li> </ol>"},{"location":"getting-started/configuration/#3-configurar-politicas-de-acesso","title":"3. Configurar Pol\u00edticas de Acesso","text":"<p>No bucket <code>video-frames</code>, v\u00e1 em Policies e adicione:</p> <pre><code>-- Permitir leitura p\u00fablica\nCREATE POLICY \"Public Access\"\nON storage.objects FOR SELECT\nUSING (bucket_id = 'video-frames');\n\n-- Permitir upload de frames\nCREATE POLICY \"Allow Frame Upload\"\nON storage.objects FOR INSERT\nWITH CHECK (bucket_id = 'video-frames');\n</code></pre>"},{"location":"getting-started/configuration/#4-obter-credenciais","title":"4. Obter Credenciais","text":"<ol> <li>V\u00e1 em Settings \u2192 API</li> <li>Copie:</li> <li>Project URL \u2192 <code>SUPABASE_URL</code></li> <li>Project API keys \u2192 <code>anon</code> <code>public</code> \u2192 <code>SUPABASE_KEY</code></li> </ol> <pre><code>SUPABASE_URL=https://xxxxxxxxxxxxx.supabase.co\nSUPABASE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS...\nSUPABASE_BUCKET=video-frames\n</code></pre>"},{"location":"getting-started/configuration/#validar-configuracao","title":"Validar Configura\u00e7\u00e3o","text":"<p>Execute este script para validar todas as credenciais:</p> <pre><code>import os\nfrom dotenv import load_dotenv\n\nload_dotenv()\n\ndef validate_config():\n    required_vars = [\n        \"GOOGLE_API_KEY\",\n        \"OPENAI_API_KEY\",\n        \"AWS_ACCESS_KEY_ID\",\n        \"AWS_SECRET_ACCESS_KEY\",\n        \"AWS_REGION\",\n        \"S3_BUCKET_NAME\",\n        \"SUPABASE_URL\",\n        \"SUPABASE_KEY\",\n        \"SUPABASE_BUCKET\"\n    ]\n\n    missing = []\n    for var in required_vars:\n        if not os.getenv(var):\n            missing.append(var)\n\n    if missing:\n        print(\"Vari\u00e1veis faltando:\")\n        for var in missing:\n            print(f\"  - {var}\")\n        return False\n\n    print(\"Todas as vari\u00e1veis configuradas!\")\n\n    # Testar conex\u00f5es\n    try:\n        from google import genai\n        client = genai.Client(api_key=os.getenv(\"GOOGLE_API_KEY\"))\n        print(\" Google Gemini: Conectado\")\n    except Exception as e:\n        print(f\" Google Gemini: {e}\")\n\n    try:\n        import boto3\n        s3 = boto3.client('s3',\n            aws_access_key_id=os.getenv(\"AWS_ACCESS_KEY_ID\"),\n            aws_secret_access_key=os.getenv(\"AWS_SECRET_ACCESS_KEY\"),\n            region_name=os.getenv(\"AWS_REGION\")\n        )\n        s3.head_bucket(Bucket=os.getenv(\"S3_BUCKET_NAME\"))\n        print(\"AWS S3: Conectado\")\n    except Exception as e:\n        print(f\"AWS S3: {e}\")\n\n    try:\n        from supabase import create_client\n        supabase = create_client(os.getenv(\"SUPABASE_URL\"), os.getenv(\"SUPABASE_KEY\"))\n        print(\"Supabase: Conectado\")\n    except Exception as e:\n        print(f\"Supabase: {e}\")\n\n    return True\n\nif __name__ == \"__main__\":\n    validate_config()\n</code></pre> <p>Salve como <code>validate_config.py</code> e execute:</p> <pre><code>python validate_config.py\n</code></pre>"},{"location":"getting-started/configuration/#configuracao-por-ambiente","title":"Configura\u00e7\u00e3o por Ambiente","text":"<p>Para ambientes diferentes (dev, staging, prod):</p> <pre><code># .env.development\nGOOGLE_API_KEY=dev_key\nS3_BUCKET_NAME=klike-videos-dev\n\n# .env.production\nGOOGLE_API_KEY=prod_key\nS3_BUCKET_NAME=klike-videos-prod\n</code></pre> <p>Carregue o ambiente correto:</p> <pre><code>from dotenv import load_dotenv\nimport os\n\nenv = os.getenv(\"ENV\", \"development\")\nload_dotenv(f\".env.{env}\")\n</code></pre>"},{"location":"getting-started/configuration/#checklist-final","title":"Checklist Final","text":"<p>Antes de continuar, verifique:</p> <ul> <li>[ ] Arquivo <code>.env</code> criado na raiz do projeto</li> <li>[ ] Todas as 9 vari\u00e1veis obrigat\u00f3rias preenchidas</li> <li>[ ] Google Gemini API Key v\u00e1lida</li> <li>[ ] OpenAI API Key v\u00e1lida</li> <li>[ ] AWS Access Key e Secret v\u00e1lidas</li> <li>[ ] Bucket S3 criado e acess\u00edvel</li> <li>[ ] Supabase projeto criado</li> <li>[ ] Bucket <code>video-frames</code> criado no Supabase</li> <li>[ ] Script <code>validate_config.py</code> executado com sucesso</li> </ul>"},{"location":"getting-started/configuration/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<p>Configura\u00e7\u00e3o conclu\u00edda! Agora voc\u00ea pode:</p> <ol> <li>\u2705 Fazer seu primeiro request</li> <li>\u2705 Explorar a API Reference</li> <li>\u2705 Implementar upload via S3</li> </ol>"},{"location":"getting-started/installation/","title":"Instala\u00e7\u00e3o","text":""},{"location":"getting-started/installation/#instalacao","title":"Instala\u00e7\u00e3o","text":"<p>Este guia ir\u00e1 ajud\u00e1-lo a configurar o ambiente de desenvolvimento do Klike AI Services.</p>"},{"location":"getting-started/installation/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<p>Antes de come\u00e7ar, certifique-se de ter instalado:</p> Ferramenta Vers\u00e3o M\u00ednima Download Python 3.10+ python.org FFmpeg 4.4+ ffmpeg.org Git 2.30+ git-scm.com"},{"location":"getting-started/installation/#verificar-instalacao","title":"Verificar Instala\u00e7\u00e3o","text":"<pre><code>python --version  # Python 3.10.0 ou superior\nffmpeg -version   # ffmpeg version 4.4 ou superior\ngit --version     # git version 2.30 ou superior\n</code></pre>"},{"location":"getting-started/installation/#instalacao-rapida","title":"Instala\u00e7\u00e3o R\u00e1pida","text":""},{"location":"getting-started/installation/#1-clone-o-repositorio","title":"1. Clone o Reposit\u00f3rio","text":"<pre><code>git clone https://github.com/klike-ai/klike-ai-services.git\ncd klike-ai-services\n</code></pre>"},{"location":"getting-started/installation/#2-crie-um-ambiente-virtual","title":"2. Crie um Ambiente Virtual","text":"WindowsLinux/macOS <pre><code>python -m venv env\n.\\env\\Scripts\\activate\n</code></pre> <pre><code>python3 -m venv env\nsource env/bin/activate\n</code></pre> <p>Por que usar ambiente virtual?</p> <p>Ambientes virtuais isolam as depend\u00eancias do projeto, evitando conflitos com outras instala\u00e7\u00f5es Python no seu sistema.</p>"},{"location":"getting-started/installation/#3-instale-as-dependencias","title":"3. Instale as Depend\u00eancias","text":"<pre><code>pip install --upgrade pip\npip install -r requirements.txt\n</code></pre> <p>Tempo de Instala\u00e7\u00e3o</p> <p>A instala\u00e7\u00e3o pode levar 5-10 minutos dependendo da sua conex\u00e3o de internet, pois inclui bibliotecas como OpenCV, FFmpeg-python, e LangChain.</p>"},{"location":"getting-started/installation/#2-instale-dependencias-de-desenvolvimento","title":"2. Instale Depend\u00eancias de Desenvolvimento","text":"<pre><code>pip install -r requirements.txt\npip install -r requirements-dev.txt  # Se existir\n</code></pre>"},{"location":"getting-started/installation/#3-instale-o-ffmpeg","title":"3. Instale o FFmpeg","text":"WindowsmacOSUbuntu/DebianCentOS/RHEL <p>Op\u00e7\u00e3o 1: Chocolatey (Recomendado) </p><pre><code>choco install ffmpeg\n</code></pre><p></p> <p>Op\u00e7\u00e3o 2: Manual 1. Baixe de ffmpeg.org/download.html 2. Extraia para <code>C:\\ffmpeg</code> 3. Adicione <code>C:\\ffmpeg\\bin</code> ao PATH</p> <pre><code>brew install ffmpeg\n</code></pre> <pre><code>sudo apt update\nsudo apt install ffmpeg\n</code></pre> <pre><code>sudo yum install ffmpeg\n</code></pre>"},{"location":"getting-started/installation/#4-verificar-instalacao-do-ffmpeg","title":"4. Verificar Instala\u00e7\u00e3o do FFmpeg","text":"<pre><code>ffmpeg -version\n</code></pre> <p>Voc\u00ea deve ver algo como:</p> <pre><code>ffmpeg version 4.4.2 Copyright (c) 2000-2021 the FFmpeg developers\nbuilt with gcc 11.2.0 (GCC)\nconfiguration: --enable-gpl --enable-version3 ...\n</code></pre>"},{"location":"getting-started/installation/#instalacao-com-docker","title":"Instala\u00e7\u00e3o com Docker","text":"<p>Em Desenvolvimento</p> <p>O suporte completo ao Docker est\u00e1 em desenvolvimento. Use a instala\u00e7\u00e3o manual por enquanto.</p> <pre><code># Dockerfile (exemplo futuro)\nFROM python:3.10-slim\n\nWORKDIR /app\n\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    ffmpeg \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nCOPY . .\n\nCMD [\"uvicorn\", \"app.app:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]\n</code></pre> <pre><code># Construir imagem\ndocker build -t klike-ai-services .\n\n# Executar container\ndocker run -p 8000:8000 --env-file .env klike-ai-services\n</code></pre>"},{"location":"getting-started/installation/#dependencias-principais","title":"Depend\u00eancias Principais","text":""},{"location":"getting-started/installation/#core-dependencies","title":"Core Dependencies","text":"Pacote Vers\u00e3o Prop\u00f3sito fastapi 0.104+ Framework web ass\u00edncrono uvicorn 0.24+ Servidor ASGI google-genai 1.0+ Cliente Google Gemini langchain-openai 0.0.2+ Integra\u00e7\u00e3o OpenAI boto3 1.28+ SDK AWS (S3, Rekognition) opencv-python 4.8+ Processamento de v\u00eddeo ffmpeg-python 0.2+ Manipula\u00e7\u00e3o de v\u00eddeo supabase 2.0+ Storage de frames"},{"location":"getting-started/installation/#dependencias-opcionais","title":"Depend\u00eancias Opcionais","text":"<pre><code># Para desenvolvimento\npip install pytest pytest-cov black isort flake8\n\n# Para documenta\u00e7\u00e3o\npip install mkdocs mkdocs-material\n</code></pre>"},{"location":"getting-started/installation/#verificacao-da-instalacao","title":"Verifica\u00e7\u00e3o da Instala\u00e7\u00e3o","text":"<p>Execute os testes b\u00e1sicos para garantir que tudo est\u00e1 funcionando:</p>"},{"location":"getting-started/installation/#1-verificar-importacoes","title":"1. Verificar Importa\u00e7\u00f5es","text":"<pre><code>python -c \"\nimport fastapi\nimport google.genai\nimport boto3\nimport cv2\nimport langchain_openai\nprint(' Todas as depend\u00eancias instaladas com sucesso!')\n\"\n</code></pre>"},{"location":"getting-started/installation/#2-iniciar-o-servidor","title":"2. Iniciar o Servidor","text":"<pre><code>uvicorn app.app:app --reload\n</code></pre> <p>Voc\u00ea deve ver:</p> <pre><code>INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)\nINFO:     Started reloader process [12345] using StatReload\nINFO:     Started server process [12346]\nINFO:     Waiting for application startup.\nINFO:     Application startup complete.\n</code></pre>"},{"location":"getting-started/installation/#3-testar-a-api","title":"3. Testar a API","text":"<p>Abra http://localhost:8000/docs no navegador.</p> <p>Voc\u00ea deve ver a interface Swagger UI interativa.</p>"},{"location":"getting-started/installation/#problemas-comuns","title":"Problemas Comuns","text":""},{"location":"getting-started/installation/#erro-modulenotfounderror-no-module-named-cv2","title":"Erro: <code>ModuleNotFoundError: No module named 'cv2'</code>","text":"<p>Solu\u00e7\u00e3o: </p><pre><code>pip uninstall opencv-python opencv-python-headless\npip install opencv-python==4.8.1.78\n</code></pre><p></p>"},{"location":"getting-started/installation/#erro-ffmpeg-not-found","title":"Erro: <code>FFmpeg not found</code>","text":"<p>Solu\u00e7\u00e3o Windows: </p><pre><code># Adicione ao PATH manualmente\n$env:Path += \";C:\\ffmpeg\\bin\"\n</code></pre><p></p> <p>Solu\u00e7\u00e3o Linux/macOS: </p><pre><code>export PATH=$PATH:/usr/local/bin/ffmpeg\n</code></pre><p></p>"},{"location":"getting-started/installation/#erro-botocoreexceptionsnocredentialserror","title":"Erro: <code>botocore.exceptions.NoCredentialsError</code>","text":"<p>Solu\u00e7\u00e3o: Configure as credenciais AWS no <code>.env</code> (veja Configura\u00e7\u00e3o)</p>"},{"location":"getting-started/installation/#erro-googleapi_coreexceptionsunauthenticated","title":"Erro: <code>google.api_core.exceptions.Unauthenticated</code>","text":"<p>Solu\u00e7\u00e3o: Verifique se a <code>GOOGLE_API_KEY</code> est\u00e1 correta no <code>.env</code></p>"},{"location":"getting-started/installation/#atualizacao","title":"Atualiza\u00e7\u00e3o","text":"<p>Para atualizar para a vers\u00e3o mais recente:</p> <pre><code>git pull origin main\npip install --upgrade -r requirements.txt\n</code></pre>"},{"location":"getting-started/installation/#proximos-passos","title":"Pr\u00f3ximos Passos","text":"<p>Agora que a instala\u00e7\u00e3o est\u00e1 completa:</p> <ol> <li>Configure as vari\u00e1veis de ambiente</li> <li>Fa\u00e7a seu primeiro request</li> <li>Explore a API Reference</li> </ol>"},{"location":"getting-started/quickstart/","title":"Primeiro Uso","text":""},{"location":"getting-started/quickstart/#quick-start","title":"Quick Start","text":"<p>Este guia r\u00e1pido vai te ajudar a fazer sua primeira an\u00e1lise de v\u00eddeo em menos de 5 minutos!</p>"},{"location":"getting-started/quickstart/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<p>Antes de come\u00e7ar, certifique-se de ter:</p> <ul> <li>\u2705 Instala\u00e7\u00e3o completa</li> <li>\u2705 Vari\u00e1veis de ambiente configuradas</li> <li>\u2705 Servidor rodando em <code>http://localhost:8000</code></li> </ul>"},{"location":"getting-started/quickstart/#seu-primeiro-video","title":"Seu Primeiro V\u00eddeo","text":""},{"location":"getting-started/quickstart/#opcao-1-upload-direto-recomendado-para-teste","title":"Op\u00e7\u00e3o 1: Upload Direto (Recomendado para Teste)","text":""},{"location":"getting-started/quickstart/#1-prepare-um-video-de-teste","title":"1. Prepare um v\u00eddeo de teste","text":"<p>Qualquer v\u00eddeo MP4 funciona! Recomenda\u00e7\u00f5es: - Dura\u00e7\u00e3o: 15-60 segundos (ideal para an\u00e1lise) - Formato: Vertical (9:16) ou quadrado (1:1) - Tamanho: At\u00e9 100MB</p>"},{"location":"getting-started/quickstart/#2-faca-o-upload-via-console-do-bucket","title":"2. Fa\u00e7a o upload via console do bucket","text":"<ol> <li>Acesse o console o servi\u00e7o s3 da AWS em https://s3.console.aws.amazon.com/s3/</li> <li>Selecione o bucket que voc\u00ea criou (ex: <code>klike-videos</code>)</li> <li>Clique em Upload \u2192 Add files \u2192 Selecione seu v\u00eddeo</li> <li>Clique em Upload</li> <li>Aguarde o upload completar</li> <li>Copie o nome do arquivo (ex: <code>meu_video.mp4</code>)</li> <li>Acesse o Swagger UI: http://localhost:8000/docs</li> <li>No Swagger UI:<ol> <li>Expanda o endpoint <code>POST /video/analyze-from-s3</code></li> <li>Clique em Try it out</li> <li>No campo <code>file_id</code>, cole o nome do arquivo (ex: <code>meu_video.mp4</code>)</li> <li>Preencha os outros campos:<ul> <li><code>audience</code>: Ex: <code>[\"millennials\"]</code></li> <li><code>platform_type</code>: Ex: <code>[\"meta\"]</code></li> <li><code>language</code>: Ex: <code>pt</code></li> </ul> </li> <li>Clique em Execute</li> </ol> </li> </ol>"},{"location":"getting-started/quickstart/#3-acompanhe-o-progresso","title":"3. Acompanhe o progresso","text":"<p>Voc\u00ea receber\u00e1 um <code>task_id</code>:</p> <pre><code>{\n  \"task_id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"status\": \"accepted\",\n  \"message\": \"An\u00e1lise iniciada...\",\n  \"check_status_url\": \"/video/task/a1b2c3d4-e5f6-7890-abcd-ef1234567890\"\n}\n</code></pre> <p>Copie o <code>task_id</code>!</p>"},{"location":"getting-started/quickstart/#4-consulte-o-resultado","title":"4. Consulte o resultado","text":"<p>No Swagger UI:</p> <ol> <li>Expanda <code>GET /video/task/{task_id}</code></li> <li>Try it out \u2192 Cole o <code>task_id</code></li> <li>Execute</li> </ol> <p>Acompanhe o <code>progress</code>:</p> <ul> <li><code>5%</code> - Upload para Gemini</li> <li><code>30%</code> - Aguardando processamento</li> <li><code>55%</code> - Processando legendas</li> <li><code>85%</code> - Analisando com IA</li> <li><code>100%</code> - Conclu\u00eddo! </li> </ul>"},{"location":"getting-started/quickstart/#entendendo-o-resultado","title":"Entendendo o Resultado","text":""},{"location":"getting-started/quickstart/#score-final","title":"Score Final","text":"<p>O score vai de 0 a 100 e \u00e9 dividido em stages:</p> Score Stage Significado 76-100 A \ud83d\udfe2 Excelente - Pronto para veicular 51-75 B \ud83d\udfe1 Bom - Pequenos ajustes recomendados 26-50 C \ud83d\udfe0 Regular - Precisa melhorias 0-25 D \ud83d\udd34 Cr\u00edtico - Refazer criativo"},{"location":"getting-started/quickstart/#creative-metrics","title":"Creative Metrics","text":"<p>Seu v\u00eddeo \u00e9 avaliado em 9 m\u00e9tricas:</p> <pre><code>{\n  \"creative_metrics\": [\n    {\n      \"metric_name\": \"3 Second Hook Score\",\n      \"score\": 85,\n      \"stage\": \"A\",\n      \"reasoning\": {\n        \"what_went_well\": [\n          \"Pergunta instigante nos primeiros 3 segundos\",\n          \"Visual atraente que captura aten\u00e7\u00e3o\"\n        ],\n        \"room_for_improvement\": [\n          \"Poderia ter um elemento surpresa maior\"\n        ]\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"getting-started/quickstart/#detected-issues","title":"Detected Issues","text":"<p>Issues t\u00e9cnicas que impactam o score:</p> <pre><code>{\n  \"detected_issues\": {\n    \"safezone\": true,\n    \"details_safezone\": {\n      \"issue\": \"Elementos fora da safe zone\",\n      \"impact\": \"Logo pode ser cortado pela UI\",\n      \"recommendation\": \"Mover para \u00e1rea central 1080x1420px\",\n      \"discount_applied\": 10,\n      \"frames_example_urls\": [\"https://...\"]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/quickstart/#actions-recomendacoes","title":"Actions (Recomenda\u00e7\u00f5es)","text":"<p>A\u00e7\u00f5es espec\u00edficas para melhorar:</p> <pre><code>{\n  \"actions\": {\n    \"actions_creatives\": {\n      \"action_hook_score\": [\n        \"Use padr\u00e3o de interrup\u00e7\u00e3o nos 3 primeiros segundos\",\n        \"Fa\u00e7a uma pergunta direta ao espectador\"\n      ]\n    },\n    \"actions_issues\": {\n      \"action_safezone\": [\n        \"Mova logo para o centro superior do frame\",\n        \"Evite colocar CTA pr\u00f3ximo \u00e0s bordas\"\n      ]\n    },\n    \"actions_platforms\": {\n      \"action_meta\": [\n        \"Adicione legendas grandes e leg\u00edveis\",\n        \"Use m\u00fasica trending do Meta Sound Collection\"\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"getting-started/quickstart/#cenarios-comuns","title":"Cen\u00e1rios Comuns","text":""},{"location":"getting-started/quickstart/#analise-rapida-para-meta","title":"An\u00e1lise R\u00e1pida para Meta","text":"<pre><code>data = {\n    \"audience\": [\"millennials\"],\n    \"platform_type\": [\"meta\"],\n    \"language\": \"pt\"\n}\n</code></pre>"},{"location":"getting-started/quickstart/#analise-multi-plataforma","title":"An\u00e1lise Multi-plataforma","text":"<pre><code>data = {\n    \"audience\": [\"genz\", \"millennials\"],\n    \"platform_type\": [\"meta\", \"tiktok\", \"linkedin\"],\n    \"language\": \"pt\"\n}\n</code></pre>"},{"location":"getting-started/quickstart/#analise-para-linkedin-b2b","title":"An\u00e1lise para LinkedIn B2B","text":"<pre><code>data = {\n    \"audience\": [\"genx\", \"boomer\"],\n    \"platform_type\": [\"linkedin\"],\n    \"language\": \"pt\"\n}\n</code></pre>"},{"location":"getting-started/quickstart/#workflow-recomendado","title":"Workflow Recomendado","text":""},{"location":"getting-started/quickstart/#para-agenciasprodutoras","title":"Para Ag\u00eancias/Produtoras","text":"<pre><code>graph TD\n    A[Receber v\u00eddeo do cliente] --&gt; B[Upload para Klike AI]\n    B --&gt; C[An\u00e1lise autom\u00e1tica]\n    C --&gt; D{Score &gt; 75?}\n    D --&gt;|Sim| E[Aprovar para veicula\u00e7\u00e3o]\n    D --&gt;|N\u00e3o| F[Implementar a\u00e7\u00f5es recomendadas]\n    F --&gt; G[Novo upload]\n    G --&gt; C\n    E --&gt; H[Deploy nas plataformas]</code></pre>"},{"location":"getting-started/quickstart/#para-criadores-de-conteudo","title":"Para Criadores de Conte\u00fado","text":"<pre><code>graph TD\n    A[Criar v\u00eddeo] --&gt; B[Upload para Klike AI]\n    B --&gt; C[Receber feedback]\n    C --&gt; D[Implementar melhorias]\n    D --&gt; E{Satisfeito?}\n    E --&gt;|N\u00e3o| B\n    E --&gt;|Sim| F[Publicar]</code></pre>"},{"location":"getting-started/quickstart/#problemas-comuns","title":"Problemas Comuns","text":""},{"location":"getting-started/quickstart/#upload-muito-lento","title":"Upload muito lento","text":"<p>Solu\u00e7\u00e3o: Use a integra\u00e7\u00e3o S3 para uploads diretos:</p> <pre><code>// Frontend faz upload direto para S3\nconst s3Upload = await uploadToS3(videoFile);\n\n// Backend s\u00f3 processa\nfetch('/video/analyze-from-s3', {\n  body: JSON.stringify({ file_id: s3Upload.id })\n});\n</code></pre>"},{"location":"getting-started/quickstart/#task-fica-em-processing-por-muito-tempo","title":"Task fica em \"processing\" por muito tempo","text":"<p>Tempos esperados:</p> <ul> <li>V\u00eddeo de 30s: ~2-3 minutos</li> <li>V\u00eddeo de 60s: ~4-5 minutos</li> </ul> <p>Se ultrapassar 10 minutos:</p> <ol> <li>Verifique o <code>task_id</code> no endpoint <code>/video/task/{task_id}</code></li> <li>Se <code>status: \"failed\"</code>, veja o campo <code>error</code></li> <li>Verifique os logs do servidor</li> </ol>"},{"location":"getting-started/quickstart/#erro-google_api_key-invalid","title":"Erro: \"GOOGLE_API_KEY invalid\"","text":"<p>Verifique o <code>.env</code>: </p><pre><code># Deve come\u00e7ar com AIzaSy...\nGOOGLE_API_KEY=AIzaSyBxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n</code></pre><p></p> <p>Teste a chave: </p><pre><code>from google import genai\nclient = genai.Client(api_key=\"sua_chave\")\nprint(client.models.list())  # Deve listar modelos\n</code></pre><p></p>"},{"location":"getting-started/quickstart/#dicas-pro","title":"Dicas Pro","text":""},{"location":"getting-started/quickstart/#batch-processing","title":"Batch Processing","text":"<p>Analise m\u00faltiplos v\u00eddeos em paralelo:</p> <pre><code>import concurrent.futures\n\nvideos = [\"video1.mp4\", \"video2.mp4\", \"video3.mp4\"]\ntask_ids = []\n\n# Upload em paralelo\nwith concurrent.futures.ThreadPoolExecutor(max_workers=3) as executor:\n    futures = [\n        executor.submit(upload_video, video) \n        for video in videos\n    ]\n    task_ids = [f.result() for f in futures]\n\nprint(f\" {len(task_ids)} v\u00eddeos em an\u00e1lise!\")\n</code></pre>"},{"location":"getting-started/quickstart/#webhook-futuro","title":"Webhook (Futuro)","text":"<p>Em breve voc\u00ea poder\u00e1 configurar webhooks para notifica\u00e7\u00f5es:</p> <pre><code>data = {\n    \"file\": video_file,\n    \"webhook_url\": \"https://seu-app.com/webhook\",\n    \"audience\": [\"millennials\"]\n}\n</code></pre> <p>** Parab\u00e9ns! Voc\u00ea completou o Quick Start!**</p> <p>Agora explore a documenta\u00e7\u00e3o completa para recursos avan\u00e7ados.</p>"}]}